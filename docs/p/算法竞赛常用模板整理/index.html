<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ÂåÖÂê´ICPCÁ´ûËµõÂ∏∏Áî®ÁöÑ‰∏Ä‰∫õÊ®°Êùø'><title>ÁÆóÊ≥ïÁ´ûËµõÂ∏∏Áî®Ê®°ÊùøÊï¥ÁêÜ</title>

<link rel='canonical' href='https://kegalas.top/p/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='ÁÆóÊ≥ïÁ´ûËµõÂ∏∏Áî®Ê®°ÊùøÊï¥ÁêÜ'>
<meta property='og:description' content='ÂåÖÂê´ICPCÁ´ûËµõÂ∏∏Áî®ÁöÑ‰∏Ä‰∫õÊ®°Êùø'>
<meta property='og:url' content='https://kegalas.top/p/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/'>
<meta property='og:site_name' content='KegalaSÁöÑ‰∏™‰∫∫ÂçöÂÆ¢'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='ÁÆóÊ≥ï' /><meta property='article:tag' content='Ê®°Êùø' /><meta property='article:published_time' content='2021-12-18T15:57:37&#43;08:00'/><meta property='article:modified_time' content='2021-12-18T15:57:37&#43;08:00'/>
<meta name="twitter:title" content="ÁÆóÊ≥ïÁ´ûËµõÂ∏∏Áî®Ê®°ÊùøÊï¥ÁêÜ">
<meta name="twitter:description" content="ÂåÖÂê´ICPCÁ´ûËµõÂ∏∏Áî®ÁöÑ‰∏Ä‰∫õÊ®°Êùø">
    <link rel="shortcut icon" href="favicon-16x16.png" />

    </head>
    <body class="
    article-page 
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        on-phone--column extended
    
">
    
        <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hue338277dc5d37c7fe2e3b3f1c288220f_302064_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ü§£</span>
                
            </figure>
            
        
        
        <h1 class="site-name"><a href="/">KegalaSÁöÑ‰∏™‰∫∫ÂçöÂÆ¢</a></h1>
        <h2 class="site-description">ÈïøÂ§ú‰º¥Êµ™Á†¥ÊôìÊ¢¶,Ê¢¶ÊôìÁ†¥Êµ™‰º¥Â§úÈïø</h2><ol class="social-menu">
                
                    <li>
                        <a 
                            href='https://space.bilibili.com/8906855'
                            target="_blank"
                            title="Bilibili"
                        >
                            
                            
                                <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 26.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="ÂõæÂ±Ç_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#BABABA;}
</style>
<path class="st0" d="M6.69,1.35l3.57,3.57h3.49l3.57-3.57c0.43-0.43,1.13-0.43,1.56,0c0.43,0.43,0.43,1.13,0,1.56l0,0l-2.01,2.01
	h2.29c2.13,0,3.85,1.72,3.85,3.85c0,0,0,0,0,0v8.8c0,2.13-1.72,3.85-3.85,3.85H4.85C2.72,21.41,1,19.69,1,17.56l0,0v-8.8
	c0-2.13,1.72-3.85,3.85-3.85l0,0h2.29L5.13,2.9c-0.43-0.43-0.43-1.13,0-1.56C5.56,0.92,6.26,0.92,6.69,1.35L6.69,1.35z M19.15,7.11
	H4.85C4,7.11,3.29,7.76,3.21,8.61L3.2,8.76v8.8c0,0.85,0.65,1.56,1.49,1.64l0.16,0.01h14.3c0.85,0,1.56-0.65,1.64-1.49l0.01-0.16
	v-8.8C20.8,7.85,20.06,7.11,19.15,7.11z M7.6,10.41c0.61,0,1.1,0.49,1.1,1.1v2.2c0,0.61-0.49,1.1-1.1,1.1s-1.1-0.49-1.1-1.1v-2.2
	C6.5,10.91,6.99,10.41,7.6,10.41z M16.4,10.41c0.61,0,1.1,0.49,1.1,1.1l0,0v2.2c0,0.61-0.49,1.1-1.1,1.1c-0.61,0-1.1-0.49-1.1-1.1
	v-2.2C15.3,10.91,15.79,10.41,16.4,10.41L16.4,10.41L16.4,10.41z"/>
</svg>

                            
                        </a>
                    </li>
                
                    <li>
                        <a 
                            href='mailto:kaoshen@outlook.com'
                            target="_blank"
                            title="E-Mail"
                        >
                            
                            
                                <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 26.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="ÂõæÂ±Ç_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#BABABA;}
</style>
<path class="st0" d="M18.88,9.46V8.53l-6.99,4.19L4.9,8.53v0.93l6.99,4.19L18.88,9.46z"/>
<path class="st0" d="M14.85,13.2l3.53,2.97l0.46-0.94l-3.13-2.51L14.85,13.2z"/>
<path class="st0" d="M22.15,12.25C22.15,6.59,17.56,2,11.89,2S1.64,6.59,1.64,12.25s4.59,10.25,10.25,10.25S22.15,17.92,22.15,12.25
	z M2.57,12.25c0-5.15,4.17-9.32,9.32-9.32s9.32,4.17,9.32,9.32s-4.17,9.32-9.32,9.32S2.57,17.4,2.57,12.25z"/>
<path class="st0" d="M4.59,15.04l0.46,0.95l3.53-2.97l-0.86-0.48L4.59,15.04z"/>
</svg>

                            
                        </a>
                    </li>
                
                    <li>
                        <a 
                            href='https://github.com/kegalas'
                            target="_blank"
                            title="GitHub"
                        >
                            
                            
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                            
                        </a>
                    </li>
                
                    <li>
                        <a 
                            href='https://vndb.org/u166447/ulist?votes=1'
                            target="_blank"
                            title="VNDB"
                        >
                            
                            
                                <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 26.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="ÂõæÂ±Ç_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;" xml:space="preserve">
<style type="text/css">
	.st0{fill:none;stroke:#BABABA;stroke-width:2;stroke-miterlimit:10;}
	.st1{fill:none;stroke:#ECECEC;stroke-miterlimit:10;}
	.st2{fill:#FFFFFF;stroke:#BABABA;stroke-miterlimit:10;}
</style>
<path class="st0" d="M1.5,2.5l8.6,15.9c0.8,1.5,3,1.5,3.8,0l8.6-15.9"/>
<g>
	<g>
		<path class="st1" d="M1.4,2.5"/>
	</g>
</g>
<g>
	<g>
		<path class="st1" d="M-2.8,2.7"/>
	</g>
</g>
<g>
	<g>
		<path class="st1" d="M-2.8,2.7"/>
	</g>
</g>
<g>
	<g>
		<path class="st1" d="M5.9,2.5"/>
	</g>
</g>
<g>
	<g>
		<path class="st1" d="M5.9,2.5"/>
	</g>
</g>
<path class="st2" d="M2.5,12.5"/>
</svg>

                            
                        </a>
                    </li>
                
            </ol></header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>ÊöóËâ≤Ê®°Âºè</span>
            </li>
        
    </ol>
</aside>

    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E7%AE%97%E6%B3%95/" >
                ÁÆóÊ≥ï
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%B8%B8%E7%94%A8%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/">ÁÆóÊ≥ïÁ´ûËµõÂ∏∏Áî®Ê®°ÊùøÊï¥ÁêÜ</a>
    </h2>

    
    <h3 class="article-subtitle">
        ÂåÖÂê´ICPCÁ´ûËµõÂ∏∏Áî®ÁöÑ‰∏Ä‰∫õÊ®°Êùø
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 18, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 21 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="ÊéíÂ∫è">ÊéíÂ∫è</h2>
<p>Âè™ÁªôÂá∫ÂΩíÂπ∂ÊéíÂ∫èÔºåÊúâÂèØËÉΩÂú®Ê±ÇÈÄÜÂ∫èÂØπÁöÑÊó∂ÂÄôÁî®Âæó‰∏ä„ÄÇÂÖ∂‰ªñÊó∂ÂÄôÊéíÂ∫èÁî®sortÂáΩÊï∞Âç≥ÂèØ„ÄÇ</p>
<h3 id="ÂΩíÂπ∂ÊéíÂ∫è">ÂΩíÂπ∂ÊéíÂ∫è</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> merge<span class="op">(</span><span class="dt">long</span> <span class="op">*</span>num<span class="op">,</span><span class="dt">long</span> <span class="op">*</span>tmp<span class="op">,</span> <span class="dt">int</span> left<span class="op">,</span> <span class="dt">int</span> mid_index <span class="op">,</span><span class="dt">int</span> right<span class="op">){</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> first<span class="op">=</span>left<span class="op">,</span> second <span class="op">=</span> mid_index<span class="op">+</span><span class="dv">1</span><span class="op">,</span> tmp_index <span class="op">=</span> left<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>first<span class="op">&lt;</span>mid_index<span class="op">+</span><span class="dv">1</span><span class="op">&amp;&amp;</span>second<span class="op">&lt;</span>right<span class="op">+</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(*(</span>num<span class="op">+</span>first<span class="op">)&lt;*(</span>num<span class="op">+</span>second<span class="op">)){</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>            tmp<span class="op">[</span>tmp_index<span class="op">]</span> <span class="op">=</span> <span class="op">*(</span>num<span class="op">+</span>first<span class="op">);</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            tmp_index<span class="op">++;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            first<span class="op">++;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span><span class="op">{</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            tmp<span class="op">[</span>tmp_index<span class="op">]</span> <span class="op">=</span> <span class="op">*(</span>num<span class="op">+</span>second<span class="op">);</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            tmp_index<span class="op">++;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            second<span class="op">++;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>first<span class="op">&lt;</span>mid_index<span class="op">+</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">[</span>tmp_index<span class="op">++]</span> <span class="op">=</span> <span class="op">*(</span>num<span class="op">+</span>first<span class="op">);</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        first<span class="op">++;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>second<span class="op">&lt;</span>right<span class="op">+</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">[</span>tmp_index<span class="op">++]</span> <span class="op">=</span> <span class="op">*(</span>num<span class="op">+</span>second<span class="op">);</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        second<span class="op">++;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span>left<span class="op">;</span>i<span class="op">&lt;=</span>right<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        num<span class="op">[</span>i<span class="op">]=</span>tmp<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> merge_sort<span class="op">(</span><span class="dt">long</span> <span class="op">*</span>num<span class="op">,</span><span class="dt">long</span> <span class="op">*</span>tmp<span class="op">,</span> <span class="dt">int</span> left<span class="op">,</span> <span class="dt">int</span> right<span class="op">){</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid_index<span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>left<span class="op">&lt;</span>right<span class="op">){</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        mid_index <span class="op">=</span> left <span class="op">+</span> <span class="op">(</span>right<span class="op">-</span>left<span class="op">)/</span><span class="dv">2</span><span class="op">;</span><span class="co">//ËøôÊ†∑ÂÜôÁñë‰ººÂèØ‰ª•ÈÅøÂÖçintÊ∫¢Âá∫</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        merge_sort<span class="op">(</span>num<span class="op">,</span>tmp<span class="op">,</span>left<span class="op">,</span>mid_index<span class="op">);</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        merge_sort<span class="op">(</span>num<span class="op">,</span>tmp<span class="op">,</span>mid_index<span class="op">+</span><span class="dv">1</span><span class="op">,</span>right<span class="op">);</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        merge<span class="op">(</span>num<span class="op">,</span>tmp<span class="op">,</span>left<span class="op">,</span>mid_index<span class="op">,</span>right<span class="op">);</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> num_count<span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> num<span class="op">[</span><span class="dv">20000</span><span class="op">];</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> tmp<span class="op">[</span><span class="dv">20000</span><span class="op">];</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;%d&quot;</span><span class="op">,&amp;</span>num_count<span class="op">);</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>num_count<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;%d&quot;</span><span class="op">,&amp;</span>num<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    merge_sort<span class="op">(</span>num<span class="op">,</span>tmp<span class="op">,</span><span class="dv">1</span><span class="op">,</span>num_count<span class="op">);</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>num_count<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;%d &quot;</span><span class="op">,</span>num<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="ÊäÄÂ∑ß">ÊäÄÂ∑ß</h2>
<h3 id="Âø´ÈÄüÂπÇ">Âø´ÈÄüÂπÇ</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> binpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> p<span class="op">){</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>p<span class="op">&gt;</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>p<span class="op">&amp;</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> res <span class="op">*</span> n<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        n <span class="op">*=</span> n<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        p<span class="op">&gt;&gt;=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> n<span class="op">,</span>p<span class="op">;</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>p<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>binpow<span class="op">(</span>n<span class="op">,</span>p<span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Á¶ªÊï£Âåñ">Á¶ªÊï£Âåñ</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Á¶ªÊï£Âåñ ‰æãÂ¶ÇÂ∞Ü1,500,40,1000‰øùÊåÅÁõ∏ÂØπÂ§ßÂ∞è‰∏çÂèòÔºåÁ¶ªÊï£Âåñ‰∏∫1,3,2,4</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> arr<span class="op">,</span>assi<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">.</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        assi<span class="op">.</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>assi<span class="op">.</span>begin<span class="op">(),</span>assi<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    unique<span class="op">(</span>assi<span class="op">.</span>begin<span class="op">(),</span>assi<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> upper_bound<span class="op">(</span>assi<span class="op">.</span>begin<span class="op">(),</span>assi<span class="op">.</span>end<span class="op">(),</span>arr<span class="op">[</span>i<span class="op">])-</span>assi<span class="op">.</span>begin<span class="op">();</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>arr<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="Â≠óÁ¨¶‰∏≤">Â≠óÁ¨¶‰∏≤</h2>
<h3 id="kmp">KMP</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">//kmp,luogu3375</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">1000005</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> nxt<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>string s1<span class="op">,</span>s2<span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> getNext<span class="op">(){</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    nxt<span class="op">[</span><span class="dv">0</span><span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> l <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>r<span class="op">&lt;</span>s2<span class="op">.</span>length<span class="op">()){</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>s2<span class="op">[</span>l<span class="op">]</span> <span class="op">==</span> s2<span class="op">[</span>r<span class="op">]){</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            nxt<span class="op">[</span>r<span class="op">]=</span>l<span class="op">+</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>            r<span class="op">++;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>            l<span class="op">++;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>l<span class="op">){</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            l <span class="op">=</span> nxt<span class="op">[</span>l<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span><span class="op">{</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            nxt<span class="op">[</span>r<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            r<span class="op">++;</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>s1<span class="op">&gt;&gt;</span>s2<span class="op">;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁªôÂÆö‰∏§‰∏™Â≠óÁ¨¶‰∏≤</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    getNext<span class="op">();</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pos<span class="op">=</span><span class="dv">0</span><span class="op">,</span>tar<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>tar<span class="op">&lt;</span>s1<span class="op">.</span>length<span class="op">())</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>s1<span class="op">[</span>tar<span class="op">]==</span>s2<span class="op">[</span>pos<span class="op">]){</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>            pos<span class="op">++;</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>            tar<span class="op">++;</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>pos<span class="op">){</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> nxt<span class="op">[</span>pos<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span><span class="op">{</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>            tar<span class="op">++;</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pos<span class="op">==</span>s2<span class="op">.</span>length<span class="op">()){</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>tar<span class="op">-</span>pos<span class="op">+</span><span class="dv">1</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">//ËæìÂá∫s2Âú®s1‰∏≠Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> nxt<span class="op">[</span>pos<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>s2<span class="op">.</span>length<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>nxt<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ë°®Á§∫s2‚ÄãÁöÑÈïøÂ∫¶‰∏∫iÁöÑÂâçÁºÄÁöÑÊúÄÈïøborderÈïøÂ∫¶„ÄÇ</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Â≠óÂÖ∏Ê†ëtrie">Â≠óÂÖ∏Ê†ë(Trie)</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">500005</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> nxt<span class="op">[</span>MAXN<span class="op">][</span><span class="dv">26</span><span class="op">];</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cnt<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> init<span class="op">(){</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>nxt<span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="kw">sizeof</span><span class="op">(</span>nxt<span class="op">));</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    cnt <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insert<span class="op">(</span>string s<span class="op">){</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> cur <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> c<span class="op">:</span>s<span class="op">){</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>nxt<span class="op">[</span>cur<span class="op">][</span>c<span class="op">-</span><span class="ch">&#39;a&#39;</span><span class="op">]){</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            nxt<span class="op">[</span>cur<span class="op">][</span>c<span class="op">-</span><span class="ch">&#39;a&#39;</span><span class="op">]=++</span>cnt<span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        cur <span class="op">=</span> nxt<span class="op">[</span>cur<span class="op">][</span>c<span class="op">-</span><span class="ch">&#39;a&#39;</span><span class="op">];</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> find_prefix<span class="op">(</span>string s<span class="op">){</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> cur<span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> c<span class="op">:</span>s<span class="op">){</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>nxt<span class="op">[</span>cur<span class="op">][</span>c <span class="op">-</span> <span class="ch">&#39;a&#39;</span><span class="op">])</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span>            </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        cur <span class="op">=</span> nxt<span class="op">[</span>cur<span class="op">][</span>c <span class="op">-</span> <span class="ch">&#39;a&#39;</span><span class="op">];</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        string s1<span class="op">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>s1<span class="op">;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        insert<span class="op">(</span>s1<span class="op">);</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>        string s1<span class="op">;</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>s1<span class="op">;</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>find_prefix<span class="op">(</span>s1<span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="Êï∞ËÆ∫">Êï∞ËÆ∫</h2>
<h3 id="Êâ©Â±ïÊ¨ßÂá†ÈáåÂæó">Êâ©Â±ïÊ¨ßÂá†ÈáåÂæó</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Ê±ÇËß£ax+by=gcd(a,b)ÁöÑ‰∏ÄÁªÑËß£</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">//Êâ©Â±ïÊ¨ßÂá†ÈáåÂæó</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> exgcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">){</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>b<span class="op">){</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span><span class="co">//Ê≠§Êó∂ax+by=gcd(a,b)‰∏≠b=0Ôºå‰ªª‰ΩïÊï∞‰∏é0ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÊòØ‰ªñÊú¨Ë∫´ÔºåÊâÄ‰ª•ax+0y=aÔºåx=1 y=0</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> exgcd<span class="op">(</span>b<span class="op">,</span> a<span class="op">%</span>b<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> t<span class="op">-(</span>a<span class="op">/</span>b<span class="op">)*</span>y<span class="op">;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>x<span class="op">,</span>y<span class="op">,</span>z<span class="op">;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> exgcd<span class="op">(</span>a<span class="op">,</span>b<span class="op">,</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>x<span class="op">&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">&lt;&lt;</span>y<span class="op">&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">&lt;&lt;</span>z<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">//x,yÁöÑÊÑè‰πâËßÅÂºÄÂ§¥ÔºåzÂç≥ÊòØÊúÄÂ§ßÂÖ¨Á∫¶Êï∞</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï">Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>a<span class="op">&lt;</span>b<span class="op">){</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        a<span class="op">=</span>a<span class="op">+</span>b<span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        b<span class="op">=</span>a<span class="op">-</span>b<span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        a<span class="op">=</span>a<span class="op">-</span>b<span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> ans <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">((</span>a<span class="op">%</span>b<span class="op">)!=</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> tmp <span class="op">=</span> a<span class="op">%</span>b<span class="op">;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>ans<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËøîÂõûÊúÄÂ§ßÂÖ¨Á∫¶Êï∞</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Ê¨ßÊãâÁ≠õ">Ê¨ßÊãâÁ≠õ</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Ê¨ßÊãâÁ≠õ</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">50005</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span> prime<span class="op">[</span>MAXN<span class="op">],</span> cnt<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_not_prime<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">//2~n‰∏≠ÊúâÂ§öÂ∞ë‰∏™Á¥†Êï∞</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>is_not_prime<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>prime<span class="op">));</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>is_not_prime<span class="op">[</span>i<span class="op">])</span>    prime<span class="op">[++</span>cnt<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>cnt<span class="op">&amp;&amp;</span>i<span class="op">*</span>prime<span class="op">[</span>j<span class="op">]&lt;=</span>n<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            is_not_prime<span class="op">[</span>i<span class="op">*</span>prime<span class="op">[</span>j<span class="op">]]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i<span class="op">%</span>prime<span class="op">[</span>j<span class="op">]==</span><span class="dv">0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>cnt<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>prime<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ËæìÂá∫Á¥†Êï∞</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="miller-rabinÁ¥†Êï∞ÊµãËØï">Miller-RabinÁ¥†Êï∞ÊµãËØï</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">//miller-rabin</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;ctime&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> test_time <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> qPowMod<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> m<span class="op">,</span> <span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>m<span class="op">==</span><span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>m<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="op">(</span>a<span class="op">%</span>n<span class="op">);</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">//‰∏çÊâìll‰ºöÊ∫¢Âá∫</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>m<span class="op">){</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>m<span class="op">&amp;</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">=</span> ans<span class="op">%</span>n<span class="op">*</span>a<span class="op">%</span>n<span class="op">;</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>a<span class="op">%</span>n<span class="op">*</span>a<span class="op">%</span>n<span class="op">;</span><span class="co">//ËøôÈáå‰∏çÊâìll‰ºöÊ∫¢Âá∫ÂØºËá¥Âà§Êñ≠ÈîôËØØ</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        m<span class="op">&gt;&gt;=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> millerRabin<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">3</span> <span class="op">||</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> n <span class="op">==</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> b <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> a <span class="op">/=</span> <span class="dv">2</span><span class="op">,</span> <span class="op">++</span>b<span class="op">;</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">// test_time ‰∏∫ÊµãËØïÊ¨°Êï∞,Âª∫ËÆÆËÆæ‰∏∫‰∏çÂ∞è‰∫é 8</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ÁöÑÊï¥Êï∞‰ª•‰øùËØÅÊ≠£Á°ÆÁéá,‰ΩÜ‰πü‰∏çÂÆúËøáÂ§ß,Âê¶Âàô‰ºöÂΩ±ÂìçÊïàÁéá</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> j<span class="op">;</span> i <span class="op">&lt;=</span> test_time<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">)</span> <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> v <span class="op">=</span> qPowMod<span class="op">(</span>x<span class="op">,</span> a<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> b<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            v <span class="op">=</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>v <span class="op">*</span> v <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>j <span class="op">&gt;=</span> b<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>millerRabin<span class="op">(</span>n<span class="op">)){</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span><span class="st">&quot;Probably a prime&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span><span class="op">{</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span><span class="st">&quot;A composite&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="‰πòÊ≥ïÈÄÜÂÖÉ">‰πòÊ≥ïÈÄÜÂÖÉ</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">//‰πòÊ≥ïÈÄÜÂÖÉ</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">//ÂàÜ‰∏∫Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÊ≥ï„ÄÅÂø´ÈÄüÂπÇÊ≥ï„ÄÅÁ∫øÊÄßÊ±ÇÈÄÜÂÖÉ</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">//ax‚â°1(mod b)Ôºåx‰∏∫aÂú®‰πòÊ≥ïÊÑè‰πâ‰∏äÁöÑÈÄÜÂÖÉÔºåËÆ∞‰Ωúa^(-1)ÔºåÊàñËÄÖinv(a)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">//Áî®Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÊ≥ïÁöÑËßíÂ∫¶ÁúãÔºåÂ∞±ÊòØÊ±Çax+by=1ÁöÑÊï¥Êï∞Ëß£</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">//Âø´ÈÄüÂπÇÊ≥ïÂà©Áî®Ë¥πÈ©¨Â∞èÂÆöÁêÜÔºåÈúÄË¶Åb‰∏∫Á¥†Êï∞</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">3000005</span><span class="op">;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> exgcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">){</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>b<span class="op">){</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> exgcd<span class="op">(</span>b<span class="op">,</span>a<span class="op">%</span>b<span class="op">,</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tmp <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> tmp <span class="op">-</span> a<span class="op">/</span>b<span class="op">*</span>y<span class="op">;</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span>   </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> exgcd_inv<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">){</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> exgcd<span class="op">(</span>a<span class="op">,</span>b<span class="op">,</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>d<span class="op">!=</span><span class="dv">1</span><span class="op">){</span><span class="co">//ÊòæÁÑ∂aÔºåbË¶Å‰∫íË¥®Êâç‰ºöÊúâÈÄÜÂÖÉ</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span><span class="st">&quot;None&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span><span class="op">{</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;(</span>x<span class="op">+</span>b<span class="op">)%</span>b<span class="op">&lt;&lt;</span>endl<span class="op">;</span><span class="co">//ÂÆûÈôÖ‰∏äÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢Âá∫Áé∞x‰∏∫Ë¥üÊï∞ÁöÑÊÉÖÂÜµ</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> qPowMod<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> b<span class="op">){</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>n<span class="op">){</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>n<span class="op">&amp;</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">=</span> ans<span class="op">%</span>b<span class="op">*</span>a<span class="op">%</span>b<span class="op">;</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a<span class="op">%</span>b<span class="op">*</span>a<span class="op">%</span>b<span class="op">;</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        n<span class="op">&gt;&gt;=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fermat_inv<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">){</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>qPowMod<span class="op">(</span>a<span class="op">,</span>b<span class="op">-</span><span class="dv">2</span><span class="op">,</span>b<span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> inv<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span>b<span class="op">,</span>n<span class="op">;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    exgcd_inv<span class="op">(</span>a<span class="op">,</span>b<span class="op">);</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">//fermat_inv(a,b);</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="co">    //Á∫øÊÄßÊ±ÇÈÄÜÂÖÉ</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co">    inv[1] = 1;</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">    for(long long i = 2;i&lt;=n;i++){</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co">        //inv[i] = -(b/i)*inv[b%i]; //ËøôÊ†∑ÂÜô‰ºöÂá∫Áé∞Ë¥üÊï∞</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">        inv[i] = (long long)(b-b/i)*inv[b%i]%b;</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="co">    }</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="co">    for(long long i=1;i&lt;=n;i++){</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">        printf(&quot;%lld\n&quot;,inv[i]);</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">    }</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Á∫øÊÄßÂêå‰ΩôÊñπÁ®ã">Á∫øÊÄßÂêå‰ΩôÊñπÁ®ã</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">//ax‚â°c (mod b)Ê±ÇËß£x</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">//Âíåax+by=cÁ≠â‰ª∑</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> exgcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">){</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>b<span class="op">){</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> exgcd<span class="op">(</span>b<span class="op">,</span> a<span class="op">%</span>b<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tmp<span class="op">=</span>x<span class="op">;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> tmp<span class="op">-</span>a<span class="op">/</span>b<span class="op">*</span>y<span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> linearEquation<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> c<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">){</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> exgcd<span class="op">(</span>a<span class="op">,</span>b<span class="op">,</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>c<span class="op">%</span>d<span class="op">!=</span><span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x<span class="op">*</span>c<span class="op">/</span>d<span class="op">;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y<span class="op">*</span>c<span class="op">/</span>d<span class="op">;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>c<span class="op">,</span>x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> d <span class="op">=</span> linearEquation<span class="op">(</span>a<span class="op">,</span>b<span class="op">,</span>c<span class="op">,</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">//dÊòØa,bÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>d<span class="op">==-</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span><span class="st">&quot;None&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span><span class="op">{</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">//cout&lt;&lt;x&lt;&lt;&quot; &quot;&lt;&lt;y&lt;&lt;endl;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        <span class="co">//‰∏ãÈù¢ËæìÂá∫ÁöÑÊòØÊúÄÂ∞èÊï¥Êï∞Ëß£</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> t <span class="op">=</span> b<span class="op">/</span>d<span class="op">;</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="op">(</span>x<span class="op">%</span>t<span class="op">+</span>t<span class="op">)%</span>t<span class="op">;</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>x<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ">‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜ</h3>
<p>Ê±ÇËß£Â¶Ç‰∏ãÊñπÁ®ã‰∏≠ÁöÑ<span class="math inline">\(x\)</span></p>
<p><span class="math display">\[
\left\{\begin{matrix}
x \equiv a_1(mod\quad r_1) \\
x \equiv a_2(mod\quad r_2 \\
\vdots \\
x \equiv a_k(mod\quad r_k)
\end{matrix}\right.
\]</span></p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">10005</span><span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> a<span class="op">[</span>MAXN<span class="op">],</span>r<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> exgcd<span class="op">(</span>ll a<span class="op">,</span> ll b<span class="op">,</span> ll <span class="op">&amp;</span>x<span class="op">,</span> ll <span class="op">&amp;</span>y<span class="op">){</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>b<span class="op">){</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    ll d <span class="op">=</span> exgcd<span class="op">(</span>b<span class="op">,</span>a<span class="op">%</span>b<span class="op">,</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    ll tmp <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> tmp <span class="op">-</span> <span class="op">(</span>a<span class="op">/</span>b<span class="op">)*</span>y<span class="op">;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k<span class="op">;</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>k<span class="op">;</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÂÖ±Êúâk‰∏™ÊñπÁ®ã</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>k<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">[</span>i<span class="op">]&gt;&gt;</span>r<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">//x‚â°ai(mod ri)</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    ll n<span class="op">=</span><span class="dv">1</span><span class="op">,</span>ans<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>k<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> n <span class="op">*</span> r<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>k<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        ll m <span class="op">=</span> n<span class="op">/</span>r<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        ll x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        exgcd<span class="op">(</span>m<span class="op">,</span>r<span class="op">[</span>i<span class="op">],</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans<span class="op">+</span>a<span class="op">[</span>i<span class="op">]*</span>m<span class="op">*</span>x<span class="op">%</span>n<span class="op">)%</span>n<span class="op">;</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>ans<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËæìÂá∫xÁöÑÂÄº</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Áî®‰πòÊ≥ïÈÄÜÂÖÉËÆ°ÁÆóÁªÑÂêàÊï∞">Áî®‰πòÊ≥ïÈÄÜÂÖÉËÆ°ÁÆóÁªÑÂêàÊï∞</h3>
<p>Ê†πÊçÆ</p>
<p><span class="math display">\[
(a/b)\%p=(a\times b^{-1})\%p=[(a\%p)\times(b^{-1}\%p)]\%p
\]</span></p>
<p>ÔºàÂ¶ÇÊûúÂä†ËΩΩ‰∏çÂÖ®ÔºåËßÅ<a
href="https://kegalas.top/p/%E5%8F%96%E4%BD%99%E8%BF%90%E7%AE%97%E7%9A%84%E5%88%86%E9%85%8D%E5%BE%8B/">Âèñ‰ΩôËøêÁÆóÁöÑÂàÜÈÖçÂæã</a>Ôºâ</p>
<p>ÂèØ‰ª•‰∏çÁî®Èô§Ê≥ïÊ±ÇÂá∫ÁªÑÂêàÊï∞„ÄÇÂÖ∂‰∏≠<span
class="math inline">\(b^{-1}\)</span>ÊòØ<span
class="math inline">\(b\)</span>Âú®Ê®°<span
class="math inline">\(p\)</span>ÊÑè‰πâ‰∏ãÁöÑÈÄÜÂÖÉ„ÄÇ</p>
<p>Ê≥®ÊÑèÈò∂‰πòÂíåÂÖ∂ÈÄÜÂÖÉÁöÑÈ¢ÑÂ§ÑÁêÜ„ÄÇ</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LL </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">200005</span><span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="dv">998244353</span><span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>LL fac<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>LL invFac<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>LL qPowMod<span class="op">(</span>LL a<span class="op">,</span> LL n<span class="op">,</span> LL b<span class="op">){</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    LL ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>n<span class="op">){</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>n<span class="op">&amp;</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">=</span> ans<span class="op">%</span>b<span class="op">*</span>a<span class="op">%</span>b<span class="op">;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a<span class="op">%</span>b<span class="op">*</span>a<span class="op">%</span>b<span class="op">;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        n<span class="op">&gt;&gt;=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>LL fermat_inv<span class="op">(</span>LL a<span class="op">,</span> LL b<span class="op">){</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> qPowMod<span class="op">(</span>a<span class="op">,</span>b<span class="op">-</span><span class="dv">2</span><span class="op">,</span>b<span class="op">);</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> init<span class="op">(</span><span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    fac<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    invFac<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        fac<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>fac<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]*</span>i<span class="op">)%</span>MOD<span class="op">;</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        invFac<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> fermat_inv<span class="op">(</span>fac<span class="op">[</span>i<span class="op">],</span>MOD<span class="op">);</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>LL comb<span class="op">(</span>LL n<span class="op">,</span> LL m<span class="op">){</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>n<span class="op">&lt;</span><span class="dv">0</span><span class="op">||</span>m<span class="op">&lt;</span><span class="dv">0</span><span class="op">||</span>m<span class="op">&gt;</span>n<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(((</span>fac<span class="op">[</span>n<span class="op">]*</span>invFac<span class="op">[</span>m<span class="op">])%</span>MOD<span class="op">)*</span>invFac<span class="op">[</span>n<span class="op">-</span>m<span class="op">])%</span>MOD<span class="op">;</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    init<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cout<span class="op">&lt;&lt;</span>comb<span class="op">(</span>n<span class="op">,</span>m<span class="op">)&lt;&lt;</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="ÂõæËÆ∫">ÂõæËÆ∫</h2>
<h3 id="ÊúÄÁü≠Ë∑Ø">ÊúÄÁü≠Ë∑Ø</h3>
<h4 id="dijkstra">Dijkstra</h4>
<div class="sourceCode" id="cb14"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;queue&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">500005</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXINT </span><span class="bn">0x7fffffff</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edge<span class="op">{</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v<span class="op">,</span>w<span class="op">;</span><span class="co">//‰∏ã‰∏ÄÁÇπÔºåÊùÉ</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> node <span class="op">{</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> dis<span class="op">,</span> u<span class="op">;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;(</span><span class="at">const</span> node<span class="op">&amp;</span> a<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> dis <span class="op">&gt;</span> a<span class="op">.</span>dis<span class="op">;</span> <span class="op">}</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span>m<span class="op">,</span>s<span class="op">;</span><span class="co">//ÁÇπÔºåËæπÔºåËµ∑ÁÇπ</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>edge<span class="op">&gt;</span> graph<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dis<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> tag<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>priority_queue<span class="op">&lt;</span>node<span class="op">,</span> vector<span class="op">&lt;</span>node<span class="op">&gt;,</span> greater<span class="op">&lt;</span>node<span class="op">&gt;</span> <span class="op">&gt;</span> pq<span class="op">;</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>n<span class="op">,&amp;</span>m<span class="op">,&amp;</span>s<span class="op">);</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>c<span class="op">;</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>a<span class="op">,&amp;</span>b<span class="op">,&amp;</span>c<span class="op">);</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        edge t<span class="op">;</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        t<span class="op">.</span>v<span class="op">=</span>b<span class="op">;</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>        t<span class="op">.</span>w<span class="op">=</span>c<span class="op">;</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>t<span class="op">);</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        dis<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> MAXINT<span class="op">;</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ÂàùÂßãÂåñ‰∏∫Êó†ÈôêËøú</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    dis<span class="op">[</span>s<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    node tmp<span class="op">;</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    tmp<span class="op">.</span>dis<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    tmp<span class="op">.</span>u<span class="op">=</span>s<span class="op">;</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    pq<span class="op">.</span>push<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>pq<span class="op">.</span>empty<span class="op">())</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> pq<span class="op">.</span>top<span class="op">().</span>u<span class="op">;</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>        pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>tag<span class="op">[</span>u<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>u<span class="op">]=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> g <span class="op">:</span> graph<span class="op">[</span>u<span class="op">]){</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> v <span class="op">=</span> g<span class="op">.</span>v<span class="op">,</span> w <span class="op">=</span> g<span class="op">.</span>w<span class="op">;</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>dis<span class="op">[</span>v<span class="op">]&gt;</span>dis<span class="op">[</span>u<span class="op">]+</span>w<span class="op">){</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>                dis<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dis<span class="op">[</span>u<span class="op">]+</span>w<span class="op">;</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>                tmp<span class="op">.</span>dis <span class="op">=</span> dis<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>                tmp<span class="op">.</span>u <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>                pq<span class="op">.</span>push<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st"> &quot;</span><span class="op">,</span>dis<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="bellman-ford">Bellman-Ford</h4>
<div class="sourceCode" id="cb15"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">500005</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define INF  </span><span class="bn">0x6fffffff</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edge<span class="op">{</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v<span class="op">;</span><span class="co">//‰∏ã‰∏ÄÁÇπ</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> w<span class="op">;</span><span class="co">//ÊùÉ</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span>m<span class="op">,</span>s<span class="op">;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dis<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>edge<span class="op">&gt;</span> graph<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">&gt;&gt;</span>s<span class="op">;</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++)</span> dis<span class="op">[</span>i<span class="op">]=</span>INF<span class="op">;</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        edge tmp<span class="op">;</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>c<span class="op">;</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">&gt;&gt;</span>c<span class="op">;</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">.</span>v<span class="op">=</span>b<span class="op">;</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">.</span>w<span class="op">=</span>c<span class="op">;</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    dis<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> flag<span class="op">;</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++)</span><span class="co">//ÊùæÂºõn-1ËΩÆÔºåËã•Á¨¨nËΩÆËøòËÉΩÊùæÂºõÔºåÂ∞±ËØ¥ÊòéÊúâË¥üÁéØ</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>        flag <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> u<span class="op">=</span><span class="dv">1</span><span class="op">;</span>u<span class="op">&lt;=</span>n<span class="op">;</span>u<span class="op">++){</span><span class="co">//ËøôÈáåÁúã‰ººÊòØ‰∏§Â±ÇÂæ™ÁéØÔºåÂÆûÈôÖ‰∏äÊÄªÊï∞ÊòØËæπÊï∞ÔºåÊï¥‰∏™ÁÆóÊ≥ïÁöÑÂ§çÊùÇÂ∫¶ÊòØmn</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> e <span class="op">:</span> graph<span class="op">[</span>u<span class="op">]){</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> w<span class="op">=</span>e<span class="op">.</span>w<span class="op">,</span>v<span class="op">=</span>e<span class="op">.</span>v<span class="op">;</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>dis<span class="op">[</span>v<span class="op">]&gt;</span>dis<span class="op">[</span>u<span class="op">]+</span>w<span class="op">){</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>                    dis<span class="op">[</span>v<span class="op">]=</span>dis<span class="op">[</span>u<span class="op">]+</span>w<span class="op">;</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>                    flag <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>flag<span class="op">){</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>flag<span class="op">&lt;&lt;</span>endl<span class="op">;</span><span class="co">//ÂèØ‰ª•ËæìÂá∫ÊòØÂê¶ÊúâË¥üÊùÉÁéØ</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">//if(dis[i]!=INF){</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>dis<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>        <span class="co">//}</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>        <span class="co">//else{</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">//    cout&lt;&lt;&quot;2147483647 &quot;;//Ê†πÊçÆluogu P3371Ë¶ÅËæìÂá∫Ëøô‰∏™Êï∞</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>        <span class="co">//}</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="spfa">SPFA</h4>
<div class="sourceCode" id="cb16"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">    bellman-fordÁöÑ‰ºòÂåñ</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Âè™Êúâ‰∏ä‰∏ÄÊ¨°Ë¢´ÊùæÂºõÁöÑÁªìÁÇπÔºåÊâÄËøûÊé•ÁöÑËæπÔºå</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">    ÊâçÊúâÂèØËÉΩÂºïËµ∑‰∏ã‰∏ÄÊ¨°ÁöÑÊùæÂºõÊìç‰Ωú</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;queue&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">500005</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="pp">#define INF  </span><span class="bn">0x5fffffff</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edge<span class="op">{</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v<span class="op">;</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> w<span class="op">;</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dis<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//Ë∑ùÁ¶ª</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cnt<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//ÁÆóÂà∞ËææÊú¨ËäÇÁÇπÊâÄË¶ÅÁªèËøáÁöÑËæπÊï∞ÔºåËã•cnt&gt;=nÔºåÂàôËØ¥ÊòéÊúâË¥üÊùÉÁéØ</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> tag<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//Áî®‰∫éÂà§Êñ≠ÊòØÂê¶‰∏∫‰∏äÊ¨°ÊùæÂºõËøáÁöÑËäÇÁÇπÁöÑËæπÊâÄËøûÁöÑÁÇπ</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span>m<span class="op">,</span>s<span class="op">;</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> qu<span class="op">;</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>edge<span class="op">&gt;</span> graph<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">&gt;&gt;</span>s<span class="op">;</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        dis<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    dis<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    tag<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>c<span class="op">;</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">&gt;&gt;</span>c<span class="op">;</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        edge tmp<span class="op">;</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">.</span>v<span class="op">=</span>b<span class="op">;</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">.</span>w<span class="op">=</span>c<span class="op">;</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    qu<span class="op">.</span>push<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_negative_circle <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(!</span>qu<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>is_negative_circle<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> qu<span class="op">.</span>front<span class="op">();</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>        qu<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>u<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> e <span class="op">:</span> graph<span class="op">[</span>u<span class="op">]){</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> v <span class="op">=</span> e<span class="op">.</span>v<span class="op">,</span> w <span class="op">=</span> e<span class="op">.</span>w<span class="op">;</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>dis<span class="op">[</span>v<span class="op">]&gt;</span>dis<span class="op">[</span>u<span class="op">]+</span>w<span class="op">){</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>                dis<span class="op">[</span>v<span class="op">]=</span>dis<span class="op">[</span>u<span class="op">]+</span>w<span class="op">;</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>                cnt<span class="op">[</span>v<span class="op">]=</span>cnt<span class="op">[</span>u<span class="op">]+</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>cnt<span class="op">[</span>v<span class="op">]&gt;=</span>n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>                    is_negative_circle <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(!</span>tag<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>                    qu<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>                    tag<span class="op">[</span>v<span class="op">]=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>is_negative_circle<span class="op">&lt;&lt;</span>endl<span class="op">;</span><span class="co">//ÂèØ‰ª•ËæìÂá∫ÊòØÂê¶ÊúâË¥üÊùÉÁéØ</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>        <span class="co">//if(dis[i]!=INF){</span></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>dis<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>        <span class="co">//}</span></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>        <span class="co">//else{</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">//    cout&lt;&lt;&quot;2147483647 &quot;;//Ê†πÊçÆluogu P3371Ë¶ÅËæìÂá∫Ëøô‰∏™Êï∞</span></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>        <span class="co">//}</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="floyd">Floyd</h4>
<div class="sourceCode" id="cb17"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">//floyd</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">5005</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXINT </span><span class="bn">0x3fffffff</span><span class="pp"> </span><span class="co">//‰∏çËÉΩËÆæÁΩÆ‰∏∫intÁöÑÊúÄÂ§ßÂÄºÔºåÂê¶ÂàôÂêéÈù¢Âä†Ê≥ïÂèØËÉΩÂØºËá¥Ê∫¢Âá∫</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> graph<span class="op">[</span>MAXN<span class="op">][</span>MAXN<span class="op">];</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span><span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>n<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>            graph<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> MAXINT<span class="op">;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>v<span class="op">;</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">&gt;&gt;</span>v<span class="op">;</span><span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>a<span class="op">][</span>b<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>k<span class="op">&lt;=</span>n<span class="op">;</span>k<span class="op">++){</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>n<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                graph<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>graph<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span>graph<span class="op">[</span>i<span class="op">][</span>k<span class="op">]+</span>graph<span class="op">[</span>k<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>n<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>graph<span class="op">[</span>i<span class="op">][</span>j<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ÊãìÊâëÊéíÂ∫è">ÊãìÊâëÊéíÂ∫è</h3>
<div class="sourceCode" id="cb18"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">//ÊãìÊâëÊéíÂ∫è</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">//ÊãìÊâëÊéíÂ∫è</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;queue&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> graph<span class="op">{</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> value<span class="op">;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> to<span class="op">;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> point</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> in_num<span class="op">;</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>graph<span class="op">&gt;</span> graph1<span class="op">;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>point1<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        point1<span class="op">[</span>i<span class="op">].</span>in_num<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>value<span class="op">;</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span><span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºõÊú¨Ê¨°ÊòØÊó†ÊùÉÂõæ</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>        graph tmp<span class="op">;</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">.</span>to<span class="op">=</span>b<span class="op">;</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        tmp<span class="op">.</span>value <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        point1<span class="op">[</span>a<span class="op">].</span>graph1<span class="op">.</span>push_back<span class="op">(</span>tmp<span class="op">);</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        point1<span class="op">[</span>b<span class="op">].</span>in_num<span class="op">++;</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> que<span class="op">;</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> ans<span class="op">;</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>point1<span class="op">[</span>i<span class="op">].</span>in_num <span class="op">==</span> <span class="dv">0</span><span class="op">){</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>            que<span class="op">.</span>push<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>que<span class="op">.</span>empty<span class="op">())</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> p <span class="op">=</span> que<span class="op">.</span>front<span class="op">();</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        que<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">.</span>push_back<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>point1<span class="op">[</span>p<span class="op">].</span>graph1<span class="op">.</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> next <span class="op">=</span> point1<span class="op">[</span>p<span class="op">].</span>graph1<span class="op">[</span>i<span class="op">].</span>to<span class="op">;</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>            point1<span class="op">[</span>next<span class="op">].</span>in_num<span class="op">--;</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>point1<span class="op">[</span>next<span class="op">].</span>in_num<span class="op">==</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>                que<span class="op">.</span>push<span class="op">(</span>next<span class="op">);</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>ans<span class="op">.</span>size<span class="op">()==</span>n<span class="op">){</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>ans<span class="op">.</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>ans<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span><span class="op">{</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span><span class="st">&quot;none&quot;</span><span class="op">;</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ÊúÄÂ∞èÁîüÊàêÊ†ë">ÊúÄÂ∞èÁîüÊàêÊ†ë</h3>
<h4 id="kruskal">Kruskal</h4>
<div class="sourceCode" id="cb19"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">200005</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> u<span class="op">[</span>MAXN<span class="op">],</span>v<span class="op">[</span>MAXN<span class="op">],</span>w<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> r<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//‰∏¥Êó∂ËæπÂ∫èÂè∑ÔºåÈó¥Êé•ÊéíÂ∫è</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_sets<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//Âπ∂Êü•ÈõÜ</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cmp<span class="op">(</span><span class="at">const</span> <span class="dt">int</span> i<span class="op">,</span> <span class="at">const</span> <span class="dt">int</span> j<span class="op">){</span><span class="cf">return</span> w<span class="op">[</span>i<span class="op">]&lt;</span>w<span class="op">[</span>j<span class="op">];}</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find<span class="op">(</span><span class="dt">int</span> x<span class="op">){</span><span class="cf">return</span> find_sets<span class="op">[</span>x<span class="op">]==</span>x <span class="op">?</span> x <span class="op">:</span> find_sets<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> find<span class="op">(</span>find_sets<span class="op">[</span>x<span class="op">]);}</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span><span class="co">//ÁÇπÊï∞ÂíåËæπÊï∞</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>u<span class="op">[</span>i<span class="op">]&gt;&gt;</span>v<span class="op">[</span>i<span class="op">]&gt;&gt;</span>w<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        find_sets<span class="op">[</span>i<span class="op">]=</span>i<span class="op">;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        r<span class="op">[</span>i<span class="op">]=</span>i<span class="op">;</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>r<span class="op">+</span><span class="dv">1</span><span class="op">,</span>r<span class="op">+</span>m<span class="op">+</span><span class="dv">1</span><span class="op">,</span>cmp<span class="op">);</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">//int cnt=0;</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp <span class="op">=</span> r<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x <span class="op">=</span> find<span class="op">(</span>u<span class="op">[</span>tmp<span class="op">]);</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> y <span class="op">=</span> find<span class="op">(</span>v<span class="op">[</span>tmp<span class="op">]);</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>x<span class="op">!=</span>y<span class="op">){</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">+=</span> w<span class="op">[</span>tmp<span class="op">];</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>            find_sets<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>            <span class="co">//cnt++;</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËÆ°Êï∞ÔºåÂ¶ÇÊûúÂ∞è‰∫én-1Âàô‰∏çËøûÈÄö</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="co">    if(cnt&lt;n-1){</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="co">        cout&lt;&lt;&quot;orz&quot;&lt;&lt;endl;</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co">        return 0;</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co">        //Â¶ÇÊûúÊòØÂ§ö‰∏™Ê†∑‰æãÊ≥®ÊÑèËøô‰∏™return 0</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="co">    }</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>ans<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="primÁÆóÊ≥ï">PrimÁÆóÊ≥ï</h4>
<div class="sourceCode" id="cb20"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;queue&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">5005</span><span class="op">;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXM <span class="op">=</span> <span class="dv">200005</span><span class="op">;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="bn">0x5fffffff</span><span class="op">;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> edge<span class="op">{</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v<span class="op">,</span>w<span class="op">;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">()=</span><span class="cf">default</span><span class="op">;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    edge<span class="op">(</span><span class="dt">int</span> v<span class="op">,</span><span class="dt">int</span> w<span class="op">):</span>v<span class="op">(</span>v<span class="op">),</span>w<span class="op">(</span>w<span class="op">){}</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;(</span><span class="at">const</span> edge<span class="op">&amp;</span> x<span class="op">)</span> <span class="at">const</span> <span class="op">{</span><span class="cf">return</span> w<span class="op">&gt;</span>x<span class="op">.</span>w<span class="op">;}</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>edge<span class="op">&gt;</span> graph<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> vis<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>priority_queue<span class="op">&lt;</span>edge<span class="op">,</span> vector<span class="op">&lt;</span>edge<span class="op">&gt;,</span> greater<span class="op">&lt;</span>edge<span class="op">&gt;</span> <span class="op">&gt;</span> pq<span class="op">;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co">//‰ª•‰∏ãorz‰ª£Ë°®‰∏çËøûÈÄö</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span><span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>n<span class="op">,&amp;</span>m<span class="op">);</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> cnt <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">,</span>c<span class="op">;</span><span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>a<span class="op">,&amp;</span>b<span class="op">,&amp;</span>c<span class="op">);</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>edge<span class="op">(</span>b<span class="op">,</span>c<span class="op">));</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>        graph<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>edge<span class="op">(</span>a<span class="op">,</span>c<span class="op">));</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Êó†ÂêëÂõæ</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>graph<span class="op">[</span><span class="dv">1</span><span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>        pq<span class="op">.</span>push<span class="op">(</span>graph<span class="op">[</span><span class="dv">1</span><span class="op">][</span>i<span class="op">]);</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    vis<span class="op">[</span><span class="dv">1</span><span class="op">]=</span><span class="kw">true</span><span class="op">;</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>cnt<span class="op">!=</span>n<span class="op">&amp;&amp;!</span>pq<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>        edge minx<span class="op">=</span>pq<span class="op">.</span>top<span class="op">();</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>        pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>vis<span class="op">[</span>minx<span class="op">.</span>v<span class="op">]){</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>pq<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>                cout<span class="op">&lt;&lt;</span><span class="st">&quot;orz&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>            minx<span class="op">=</span>pq<span class="op">.</span>top<span class="op">();</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>            pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>        vis<span class="op">[</span>minx<span class="op">.</span>v<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">+=</span>minx<span class="op">.</span>w<span class="op">;</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>        cnt<span class="op">++;</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>graph<span class="op">[</span>minx<span class="op">.</span>v<span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>vis<span class="op">[</span>graph<span class="op">[</span>minx<span class="op">.</span>v<span class="op">][</span>i<span class="op">].</span>v<span class="op">])</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>                pq<span class="op">.</span>push<span class="op">(</span>graph<span class="op">[</span>minx<span class="op">.</span>v<span class="op">][</span>i<span class="op">]);</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>cnt<span class="op">&lt;</span>n<span class="op">){</span></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span><span class="st">&quot;orz&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span><span class="op">{</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>ans<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ÊúÄÂ∞èÊ†ëÂΩ¢Âõæ">ÊúÄÂ∞èÊ†ëÂΩ¢Âõæ</h3>
<h4 id="Êú±ÂàòÁÆóÊ≥ï">Êú±ÂàòÁÆóÊ≥ï</h4>
<div class="sourceCode" id="cb21"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">//ÊúÄÂ∞èÊ†ëÂΩ¢ÂõæÔºåÊú±ÂàòÁÆóÊ≥ï</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">//‰ªéÊ†πËäÇÁÇπËÉΩÂà∞ËææÂÖ∂‰ªñÊâÄÊúâÁÇπ</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">//luogu4716</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">105</span><span class="op">;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXM <span class="op">=</span> <span class="dv">10005</span><span class="op">;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="bn">0x7fffffff</span><span class="op">;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Edge<span class="op">{</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> u<span class="op">,</span>v<span class="op">,</span>w<span class="op">;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>Edge edge<span class="op">[</span>MAXM<span class="op">];</span> </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> vis<span class="op">[</span>MAXN<span class="op">],</span>id<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> in<span class="op">[</span>MAXN<span class="op">],</span>pre<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span>m<span class="op">,</span>root<span class="op">;</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> zhuliu<span class="op">(){</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(;;){</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++)</span> in<span class="op">[</span>i<span class="op">]=</span>INF<span class="op">;</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> u <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>u<span class="op">;</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> v <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>v<span class="op">;</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>u<span class="op">!=</span>v<span class="op">&amp;&amp;</span>edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">&lt;</span>in<span class="op">[</span>v<span class="op">]){</span><span class="co">//ÈÅçÂéÜÊâÄÊúâËæπÔºåÊâæÂà∞ÂØπÊØè‰∏™ÁÇπÁöÑÊúÄÁü≠ÂÖ•Ëæπ</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                in<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">;</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>                pre<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i<span class="op">!=</span>root<span class="op">&amp;&amp;</span>in<span class="op">[</span>i<span class="op">]==</span>INF<span class="op">){</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span><span class="co">//Êó†Ëß£</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span><span class="co">//ËÆ∞ÂΩïÁéØÊï∞‰ª•Âèä‰∏ã‰∏ÄÊ¨°Âæ™ÁéØÁöÑÁÇπÊï∞</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>            vis<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>            id<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>        in<span class="op">[</span>root<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>i<span class="op">==</span>root<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>            ans <span class="op">+=</span> in<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> v<span class="op">=</span>i<span class="op">;</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span><span class="op">(</span>vis<span class="op">[</span>v<span class="op">]!=</span>i<span class="op">&amp;&amp;</span>id<span class="op">[</span>v<span class="op">]==-</span><span class="dv">1</span><span class="op">&amp;&amp;</span>v<span class="op">!=</span>root<span class="op">){</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>                vis<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>                v <span class="op">=</span> pre<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>v<span class="op">!=</span>root<span class="op">&amp;&amp;</span>id<span class="op">[</span>v<span class="op">]==-</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>                id<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>cnt<span class="op">;</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> u<span class="op">=</span>pre<span class="op">[</span>v<span class="op">];</span>u<span class="op">!=</span>v<span class="op">;</span>u<span class="op">=</span>pre<span class="op">[</span>u<span class="op">])</span> id<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> cnt<span class="op">;</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>cnt<span class="op">==</span><span class="dv">0</span><span class="op">){</span><span class="co">//Êó†ÁéØÔºåÂæóÂà∞Ëß£</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>id<span class="op">[</span>i<span class="op">]==-</span><span class="dv">1</span><span class="op">)</span> id<span class="op">[</span>i<span class="op">]=++</span>cnt<span class="op">;</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> u <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>u<span class="op">;</span></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> v <span class="op">=</span> edge<span class="op">[</span>i<span class="op">].</span>v<span class="op">;</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>            edge<span class="op">[</span>i<span class="op">].</span>u <span class="op">=</span> id<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>            edge<span class="op">[</span>i<span class="op">].</span>v <span class="op">=</span> id<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>edge<span class="op">[</span>i<span class="op">].</span>u<span class="op">!=</span>edge<span class="op">[</span>i<span class="op">].</span>v<span class="op">)</span> edge<span class="op">[</span>i<span class="op">].</span>w <span class="op">-=</span> in<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> cnt<span class="op">;</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>        root <span class="op">=</span> id<span class="op">[</span>root<span class="op">];</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">&gt;&gt;</span>root<span class="op">;</span><span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞ÔºåÊ†πËäÇÁÇπÂ∫èÂè∑</span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>edge<span class="op">[</span>i<span class="op">].</span>u<span class="op">&gt;&gt;</span>edge<span class="op">[</span>i<span class="op">].</span>v<span class="op">&gt;&gt;</span>edge<span class="op">[</span>i<span class="op">].</span>w<span class="op">;</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÊùÉ</span></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>zhuliu<span class="op">()&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ÁΩëÁªúÊµÅ">ÁΩëÁªúÊµÅ</h3>
<h4 id="ÊúÄÂ§ßÊµÅ">ÊúÄÂ§ßÊµÅ</h4>
<h5 id="ford-fulkerson">Ford-Fulkerson</h5>
<h6 id="dfsÂÆûÁé∞ÁöÑford-fulkerson">DFSÂÆûÁé∞ÁöÑFord-Fulkerson</h6>
<div class="sourceCode" id="cb22"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">//luogu P3376</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">//Ë∂ÖÊó∂</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> ull<span class="op">;</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> ll INF <span class="op">=</span> <span class="bn">0xffffffff</span><span class="op">;</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXM <span class="op">=</span> <span class="dv">100005</span><span class="op">;</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Edge<span class="op">{</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> to<span class="op">;</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rev<span class="op">;</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    ll cap<span class="op">;</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    Edge<span class="op">()=</span><span class="cf">default</span><span class="op">;</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    Edge<span class="op">(</span><span class="dt">int</span> to<span class="op">,</span> ll cap<span class="op">,</span> <span class="dt">int</span> rev<span class="op">):</span>to<span class="op">(</span>to<span class="op">),</span>cap<span class="op">(</span>cap<span class="op">),</span>rev<span class="op">(</span>rev<span class="op">){}</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Edge<span class="op">&gt;</span> G<span class="op">[</span>MAXM<span class="op">];</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> used<span class="op">[</span>MAXM<span class="op">];</span> </span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>ll dfs<span class="op">(</span><span class="dt">int</span> v<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> ll f<span class="op">){</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>v<span class="op">==</span>t<span class="op">)</span> <span class="cf">return</span> f<span class="op">;</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    used<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>G<span class="op">[</span>v<span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>        Edge<span class="op">&amp;</span> e<span class="op">=</span>G<span class="op">[</span>v<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>used<span class="op">[</span>e<span class="op">.</span>to<span class="op">]&amp;&amp;</span>e<span class="op">.</span>cap<span class="op">&gt;</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>            ll d <span class="op">=</span> dfs<span class="op">(</span>e<span class="op">.</span>to<span class="op">,</span> t<span class="op">,</span> min<span class="op">(</span>f<span class="op">,</span>e<span class="op">.</span>cap<span class="op">));</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>d<span class="op">&gt;</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>                e<span class="op">.</span>cap<span class="op">-=</span>d<span class="op">;</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>                G<span class="op">[</span>e<span class="op">.</span>to<span class="op">][</span>e<span class="op">.</span>rev<span class="op">].</span>cap<span class="op">+=</span>d<span class="op">;</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>ll max_flow<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">){</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    ll flow <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(;;){</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>used<span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="kw">sizeof</span><span class="op">(</span>used<span class="op">));</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>        ll f <span class="op">=</span> dfs<span class="op">(</span>s<span class="op">,</span>t<span class="op">,</span>INF<span class="op">);</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>f<span class="op">==</span><span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> flow<span class="op">;</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>        flow<span class="op">+=</span>f<span class="op">;</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> s<span class="op">,</span>t<span class="op">;</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>s<span class="op">&gt;&gt;</span>t<span class="op">;</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Ê∫êÁÇπÔºåÊ±áÁÇπ</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>        ll c<span class="op">;</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%ld</span><span class="st">&quot;</span><span class="op">,&amp;</span>a<span class="op">,&amp;</span>b<span class="op">,&amp;</span>c<span class="op">);</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÂÆπÈáè</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>        <span class="co">//cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>        G<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>Edge<span class="op">(</span>b<span class="op">,</span>c<span class="op">,</span>G<span class="op">[</span>b<span class="op">].</span>size<span class="op">()));</span><span class="co">//ËøôÈáåÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÂÆûÈôÖ‰∏äÊòØÂèçÂêëËæπÁöÑÁºñÂè∑</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>        G<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>Edge<span class="op">(</span>a<span class="op">,</span><span class="dv">0</span><span class="op">,</span>G<span class="op">[</span>a<span class="op">].</span>size<span class="op">()-</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>    ll ans <span class="op">=</span> max_flow<span class="op">(</span>s<span class="op">,</span>t<span class="op">);</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÂæóÂà∞ÊúÄÂ§ßÊµÅ</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%ld</span><span class="st">&quot;</span><span class="op">,</span>ans<span class="op">);</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">//cout&lt;&lt;ans&lt;&lt;endl;</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a><span class="co">4 5 4 3</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a><span class="co">4 2 30</span></span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a><span class="co">4 3 20</span></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a><span class="co">2 3 20</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a><span class="co">2 1 30</span></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="co">1 3 40</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span></code></pre></div>
<h6 id="edmondskarp">EdmondsKarp</h6>
<div class="sourceCode" id="cb23"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;queue&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">205</span><span class="op">;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> ll INF <span class="op">=</span> <span class="dv">1</span><span class="bu">LL</span><span class="op">&lt;&lt;</span><span class="dv">35</span><span class="op">;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Edge<span class="op">{</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> from<span class="op">,</span> to<span class="op">;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    ll cap<span class="op">,</span>flow<span class="op">;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    Edge<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">,</span> ll c<span class="op">,</span> ll f<span class="op">):</span>from<span class="op">(</span>u<span class="op">),</span>to<span class="op">(</span>v<span class="op">),</span>cap<span class="op">(</span>c<span class="op">),</span>flow<span class="op">(</span>f<span class="op">){}</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> EdmondKarp<span class="op">{</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>Edge<span class="op">&gt;</span> edges<span class="op">;</span>  </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> G<span class="op">[</span>MAXN<span class="op">];</span> <span class="co">//ÈÇªÊé•Ë°®</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    ll a<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    ll p<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> init<span class="op">(</span><span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            G<span class="op">[</span>i<span class="op">].</span>clear<span class="op">();</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">.</span>clear<span class="op">();</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> AddEdge<span class="op">(</span><span class="dt">int</span> from<span class="op">,</span> <span class="dt">int</span> to<span class="op">,</span> ll cap<span class="op">){</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">.</span>push_back<span class="op">(</span>Edge<span class="op">(</span>from<span class="op">,</span> to<span class="op">,</span> cap<span class="op">,</span> <span class="dv">0</span><span class="op">));</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">.</span>push_back<span class="op">(</span>Edge<span class="op">(</span>to<span class="op">,</span> from<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">));</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> edges<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        G<span class="op">[</span>from<span class="op">].</span>push_back<span class="op">(</span>m<span class="op">-</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        G<span class="op">[</span>to<span class="op">].</span>push_back<span class="op">(</span>m<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> Maxflow<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">){</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        ll flow <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(;;){</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>            memset<span class="op">(</span>a<span class="op">,</span> <span class="dv">0</span> <span class="op">,</span><span class="kw">sizeof</span><span class="op">(</span>a<span class="op">));</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>            queue<span class="op">&lt;</span>ll<span class="op">&gt;</span> Q<span class="op">;</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>            Q<span class="op">.</span>push<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span><span class="op">(!</span>Q<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>                ll x<span class="op">=</span>Q<span class="op">.</span>front<span class="op">();</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>                Q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>G<span class="op">[</span>x<span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>                    Edge<span class="op">&amp;</span> e <span class="op">=</span> edges<span class="op">[</span>G<span class="op">[</span>x<span class="op">][</span>i<span class="op">]];</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span><span class="op">(!</span>a<span class="op">[</span>e<span class="op">.</span>to<span class="op">]&amp;&amp;</span>e<span class="op">.</span>cap<span class="op">&gt;</span>e<span class="op">.</span>flow<span class="op">){</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                        p<span class="op">[</span>e<span class="op">.</span>to<span class="op">]</span> <span class="op">=</span> G<span class="op">[</span>x<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                        a<span class="op">[</span>e<span class="op">.</span>to<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>a<span class="op">[</span>x<span class="op">],</span> e<span class="op">.</span>cap<span class="op">-</span>e<span class="op">.</span>flow<span class="op">);</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>                        Q<span class="op">.</span>push<span class="op">(</span>e<span class="op">.</span>to<span class="op">);</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>a<span class="op">[</span>t<span class="op">])</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(!</span>a<span class="op">[</span>t<span class="op">])</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> u<span class="op">=</span>t<span class="op">;</span>u<span class="op">!=</span>s<span class="op">;</span>u<span class="op">=</span>edges<span class="op">[</span>p<span class="op">[</span>u<span class="op">]].</span>from<span class="op">){</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>                edges<span class="op">[</span>p<span class="op">[</span>u<span class="op">]].</span>flow<span class="op">+=</span>a<span class="op">[</span>t<span class="op">];</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>                edges<span class="op">[</span>p<span class="op">[</span>u<span class="op">]^</span><span class="dv">1</span><span class="op">].</span>flow <span class="op">-=</span> a<span class="op">[</span>t<span class="op">];</span></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>            flow <span class="op">+=</span> a<span class="op">[</span>t<span class="op">];</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> flow<span class="op">;</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    EdmondKarp EK<span class="op">;</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>EK<span class="op">.</span>n<span class="op">;</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> s<span class="op">,</span>t<span class="op">;</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m<span class="op">;</span></span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>m<span class="op">&gt;&gt;</span>s<span class="op">&gt;&gt;</span>t<span class="op">;</span></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËæπÊï∞ÔºåÊ∫êÁÇπÔºåÊ±áÁÇπ</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp1<span class="op">,</span>tmp2<span class="op">,</span>tmp3<span class="op">;</span></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>tmp1<span class="op">&gt;&gt;</span>tmp2<span class="op">&gt;&gt;</span>tmp3<span class="op">;</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπÔºåËæπÂÆπÈáè</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>        EK<span class="op">.</span>AddEdge<span class="op">(</span>tmp1<span class="op">,</span>tmp2<span class="op">,</span>tmp3<span class="op">);</span></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>EK<span class="op">.</span>Maxflow<span class="op">(</span>s<span class="op">,</span>t<span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ËøûÈÄöÊÄßÁõ∏ÂÖ≥">ËøûÈÄöÊÄßÁõ∏ÂÖ≥</h3>
<h4 id="Âº∫ËøûÈÄöÂàÜÈáè">Âº∫ËøûÈÄöÂàÜÈáè</h4>
<h5 id="tarjanÁÆóÊ≥ï">TarjanÁÆóÊ≥ï</h5>
<div class="sourceCode" id="cb24"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stack&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">5005</span><span class="op">;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXM <span class="op">=</span> <span class="dv">10005</span><span class="op">;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfn<span class="op">[</span>MAXN<span class="op">],</span> low<span class="op">[</span>MAXN<span class="op">],</span> instk<span class="op">[</span>MAXN<span class="op">],</span> scc<span class="op">[</span>MAXN<span class="op">],</span> cnt<span class="op">=</span><span class="dv">0</span><span class="op">,</span> cscc<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">//scc‰ª£Ë°®ÊØè‰∏™Â∫óÊâÄÂ±ûÁöÑÂº∫ËøûÈÄöÂàÜÈáèÁöÑÁºñÂè∑</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> edges<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>stack<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> stk<span class="op">;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> tarjan<span class="op">(</span><span class="dt">int</span> u<span class="op">){</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> dfn<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>cnt<span class="op">;</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    instk<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    stk<span class="op">.</span>push<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>edges<span class="op">[</span>u<span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> edges<span class="op">[</span>u<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>dfn<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>            tarjan<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span>low<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>instk<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> dfn<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>low<span class="op">[</span>u<span class="op">]==</span>dfn<span class="op">[</span>u<span class="op">]){</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> top<span class="op">;</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        cscc<span class="op">++;</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">do</span><span class="op">{</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>            top <span class="op">=</span> stk<span class="op">.</span>top<span class="op">();</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>            stk<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>            instk<span class="op">[</span>top<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>            scc<span class="op">[</span>top<span class="op">]</span> <span class="op">=</span> cscc<span class="op">;</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span><span class="cf">while</span><span class="op">(</span>top<span class="op">!=</span>u<span class="op">);</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπ</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>dfn<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>            tarjan<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>scc<span class="op">[</span>i<span class="op">]&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Ââ≤ÁÇπ">Ââ≤ÁÇπ</h3>
<h4 id="tarjanÁÆóÊ≥ï-1">TarjanÁÆóÊ≥ï</h4>
<div class="sourceCode" id="cb25"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">//tarjanÊ±ÇÂâ≤ÁÇπ,luogu P3388</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stack&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">20005</span><span class="op">;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXM <span class="op">=</span> <span class="dv">100005</span><span class="op">;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfn<span class="op">[</span>MAXN<span class="op">],</span> low<span class="op">[</span>MAXN<span class="op">],</span> cnt<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> edges<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> cut<span class="op">;</span><span class="co">//Â≠òÂÇ®Ââ≤ÁÇπ</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> tarjan<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">bool</span> root <span class="op">=</span> <span class="kw">true</span><span class="op">){</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tot <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> dfn<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>cnt<span class="op">;</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>edges<span class="op">[</span>u<span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> edges<span class="op">[</span>u<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>dfn<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>            tarjan<span class="op">(</span>v<span class="op">,</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span>low<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>            tot <span class="op">+=</span> <span class="op">(</span>low<span class="op">[</span>v<span class="op">]&gt;=</span>dfn<span class="op">[</span>u<span class="op">]);</span><span class="co">//ÁªüËÆ°Êª°Ë∂≥ÁöÑÁÇπÁöÑ‰∏™Êï∞</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span><span class="op">{</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> dfn<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>tot<span class="op">&gt;</span>root<span class="op">){</span><span class="co">//Â¶ÇÊûúÊòØÊ†πËäÇÁÇπÔºåÂàôÈúÄË¶ÅÊúâËá≥Â∞ë‰∏§‰∏™Â≠êÊ†ëÔºåÂê¶ÂàôÂè™ÈúÄË¶ÅÊúâ‰∏Ä‰∏™Â≠êÊ†ë</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        cut<span class="op">.</span>push_back<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπ</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Êó†ÂêëÂõæ</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>dfn<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>            tarjan<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>cut<span class="op">.</span>size<span class="op">()&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>cut<span class="op">.</span>begin<span class="op">(),</span>cut<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>cut<span class="op">.</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>cut<span class="op">[</span>i<span class="op">]&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ËæìÂá∫Ââ≤ÁÇπÁöÑÁºñÂè∑</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Ââ≤Ëæπ">Ââ≤Ëæπ</h3>
<h4 id="tarjanÁÆóÊ≥ï-2">TarjanÁÆóÊ≥ï</h4>
<div class="sourceCode" id="cb26"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">//tarjanÊ±ÇÂâ≤Ëæπ</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stack&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">20005</span><span class="op">;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXM <span class="op">=</span> <span class="dv">100005</span><span class="op">;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfn<span class="op">[</span>MAXN<span class="op">],</span> low<span class="op">[</span>MAXN<span class="op">],</span> cnt<span class="op">=</span><span class="dv">0</span><span class="op">,</span> fa<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//faËÆ∞ÂΩïÁà∂ËäÇÁÇπ</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> edges<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;&gt;</span> bridges<span class="op">;</span><span class="co">//Â≠òÂÇ®Ââ≤Ëæπ</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> tarjan<span class="op">(</span><span class="dt">int</span> u<span class="op">){</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> dfn<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>cnt<span class="op">;</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>edges<span class="op">[</span>u<span class="op">].</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> edges<span class="op">[</span>u<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>dfn<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>            fa<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>            tarjan<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span>low<span class="op">[</span>v<span class="op">]);</span>            </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>low<span class="op">[</span>v<span class="op">]&gt;</span>dfn<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                bridges<span class="op">.</span>emplace_back<span class="op">(</span>u<span class="op">,</span>v<span class="op">);</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>fa<span class="op">[</span>u<span class="op">]!=</span>v<span class="op">){</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> dfn<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞ÔºåËæπÊï∞</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Ëµ∑ÁÇπÔºåÁªàÁÇπ</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>        edges<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Êó†ÂêëÂõæ</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>dfn<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>            tarjan<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>bridges<span class="op">.</span>size<span class="op">()&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>bridges<span class="op">.</span>size<span class="op">();</span>i<span class="op">++){</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>bridges<span class="op">[</span>i<span class="op">].</span>first<span class="op">&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">&lt;&lt;</span>bridges<span class="op">[</span>i<span class="op">].</span>second<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ËæìÂá∫Ââ≤Ëæπ</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="ËÆ°ÁÆóÂá†‰Ωï">ËÆ°ÁÆóÂá†‰Ωï</h2>
<h3 id="‰∫åÁª¥Âá∏ÂåÖ">‰∫åÁª¥Âá∏ÂåÖ</h3>
<h4 id="andrewÊâ´ÊèèÊ≥ï">AndrewÊâ´ÊèèÊ≥ï</h4>
<div class="sourceCode" id="cb27"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">50005</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point<span class="op">{</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    Point<span class="op">()=</span><span class="cf">default</span><span class="op">;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    Point<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">):</span>x<span class="op">(</span>x<span class="op">),</span>y<span class="op">(</span>y<span class="op">){}</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    Point <span class="kw">operator</span> <span class="op">+</span> <span class="op">(</span>Point p<span class="op">){</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Point<span class="op">(</span>x<span class="op">+</span>p<span class="op">.</span>x<span class="op">,</span> y<span class="op">+</span>p<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    Point <span class="kw">operator</span> <span class="op">-</span> <span class="op">(</span>Point p<span class="op">){</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Point<span class="op">(</span>x<span class="op">-</span>p<span class="op">.</span>x<span class="op">,</span> y<span class="op">-</span>p<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    Point <span class="kw">operator</span> <span class="op">*</span> <span class="op">(</span><span class="dt">double</span> d<span class="op">){</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Point<span class="op">(</span>x<span class="op">*</span>d<span class="op">,</span> y<span class="op">*</span>d<span class="op">);</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> dot<span class="op">(</span>Point p<span class="op">){</span><span class="co">//ÁÇπÁßØ</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">*</span>p<span class="op">.</span>x<span class="op">+</span>y<span class="op">*</span>p<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> det<span class="op">(</span>Point p<span class="op">){</span><span class="co">//ÂèâÁßØ</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">*(</span>p<span class="op">.</span>y<span class="op">)-(</span>p<span class="op">.</span>x<span class="op">)*</span>y<span class="op">;</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>Point po<span class="op">[</span>MAXN<span class="op">*</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> cmp<span class="op">(</span>Point<span class="op">&amp;</span> a<span class="op">,</span> Point<span class="op">&amp;</span> b<span class="op">){</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>a<span class="op">.</span>x<span class="op">!=</span>b<span class="op">.</span>x<span class="op">)</span> <span class="cf">return</span> a<span class="op">.</span>x<span class="op">&lt;</span>b<span class="op">.</span>x<span class="op">;</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">.</span>y<span class="op">&lt;</span>b<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> convexHull<span class="op">(){</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËøîÂõûÂá∏ÂåÖ‰∏äÁöÑÁÇπ</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> qs<span class="op">;</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>k<span class="op">&gt;</span><span class="dv">1</span><span class="op">&amp;&amp;(</span>qs<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">]-</span>qs<span class="op">[</span>k<span class="op">-</span><span class="dv">2</span><span class="op">]).</span>det<span class="op">(</span>po<span class="op">[</span>i<span class="op">]-</span>qs<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">])&lt;=</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>            qs<span class="op">.</span>erase<span class="op">(</span>qs<span class="op">.</span>end<span class="op">()-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>            k<span class="op">--;</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>        qs<span class="op">.</span>push_back<span class="op">(</span>po<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>        k<span class="op">++;</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span>n<span class="op">-</span><span class="dv">2</span><span class="op">,</span>t<span class="op">=</span>k<span class="op">;</span>i<span class="op">&gt;=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">--){</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>k<span class="op">&gt;</span>t<span class="op">&amp;&amp;(</span>qs<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">]-</span>qs<span class="op">[</span>k<span class="op">-</span><span class="dv">2</span><span class="op">]).</span>det<span class="op">(</span>po<span class="op">[</span>i<span class="op">]-</span>qs<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">])&lt;=</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>            qs<span class="op">.</span>erase<span class="op">(</span>qs<span class="op">.</span>end<span class="op">()-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>            k<span class="op">--;</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>        qs<span class="op">.</span>push_back<span class="op">(</span>po<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>        k<span class="op">++;</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    qs<span class="op">.</span>erase<span class="op">(</span>qs<span class="op">.</span>end<span class="op">()-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> qs<span class="op">;</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>po<span class="op">[</span>i<span class="op">].</span>x<span class="op">&gt;&gt;</span>po<span class="op">[</span>i<span class="op">].</span>y<span class="op">;</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ËæìÂÖ•ÁÇπÁöÑÊ®™Á∫µÂùêÊ†á</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>po<span class="op">,</span>po<span class="op">+</span>n<span class="op">,</span>cmp<span class="op">);</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> p<span class="op">:</span>convexHull<span class="op">()){</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>p<span class="op">.</span>x<span class="op">&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">&lt;&lt;</span>p<span class="op">.</span>y<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ÊóãËΩ¨Âç°Â£≥Ê±ÇÊúÄËøúÁÇπÂØπ">ÊóãËΩ¨Âç°Â£≥Ê±ÇÊúÄËøúÁÇπÂØπ</h3>
<div class="sourceCode" id="cb28"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Luogu P1452</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">//ÊóãËΩ¨Âç°Â£≥ÂíåÂá∏ÂåÖ</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">50005</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point<span class="op">{</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    Point<span class="op">()=</span><span class="cf">default</span><span class="op">;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    Point<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">):</span>x<span class="op">(</span>x<span class="op">),</span>y<span class="op">(</span>y<span class="op">){}</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    Point <span class="kw">operator</span> <span class="op">-</span> <span class="op">(</span>Point p<span class="op">){</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Point<span class="op">(</span>x<span class="op">-</span>p<span class="op">.</span>x<span class="op">,</span> y<span class="op">-</span>p<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    Point <span class="kw">operator</span> <span class="op">+</span> <span class="op">(</span>Point p<span class="op">){</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Point<span class="op">(</span>x<span class="op">+</span>p<span class="op">.</span>x<span class="op">,</span> y<span class="op">+</span>p<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    Point <span class="kw">operator</span> <span class="op">*</span> <span class="op">(</span><span class="dt">int</span> d<span class="op">){</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> Point<span class="op">(</span>x<span class="op">*</span>d<span class="op">,</span> y<span class="op">*</span>d<span class="op">);</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dot<span class="op">(</span>Point p<span class="op">){</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">*</span>p<span class="op">.</span>x<span class="op">+</span>y<span class="op">*</span>p<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> det<span class="op">(</span>Point p<span class="op">){</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x<span class="op">*(</span>p<span class="op">.</span>y<span class="op">)-</span>y<span class="op">*(</span>p<span class="op">.</span>x<span class="op">);</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> cmp<span class="op">(</span>Point<span class="op">&amp;</span> a<span class="op">,</span> Point<span class="op">&amp;</span> b<span class="op">){</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>a<span class="op">.</span>x<span class="op">!=</span>b<span class="op">.</span>x<span class="op">)</span> <span class="cf">return</span> a<span class="op">.</span>x<span class="op">&lt;</span>b<span class="op">.</span>x<span class="op">;</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">.</span>y<span class="op">&lt;</span>b<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>Point po<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> convexHull<span class="op">(){</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËøîÂõûÂá∏ÂåÖ‰∏äÁöÑÁÇπ</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> ans<span class="op">;</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>k<span class="op">&gt;</span><span class="dv">1</span><span class="op">&amp;&amp;(</span>ans<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">]-</span>ans<span class="op">[</span>k<span class="op">-</span><span class="dv">2</span><span class="op">]).</span>det<span class="op">(</span>po<span class="op">[</span>i<span class="op">]-</span>ans<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">])&lt;=</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>            ans<span class="op">.</span>erase<span class="op">(</span>ans<span class="op">.</span>end<span class="op">()-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>            k<span class="op">--;</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">.</span>push_back<span class="op">(</span>po<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>        k<span class="op">++;</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span>n<span class="op">-</span><span class="dv">2</span><span class="op">,</span>t<span class="op">=</span>k<span class="op">;</span>i<span class="op">&gt;=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">--){</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>k<span class="op">&gt;</span>t<span class="op">&amp;&amp;(</span>ans<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">]-</span>ans<span class="op">[</span>k<span class="op">-</span><span class="dv">2</span><span class="op">]).</span>det<span class="op">(</span>po<span class="op">[</span>i<span class="op">]-</span>ans<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">])&lt;=</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>            ans<span class="op">.</span>erase<span class="op">(</span>ans<span class="op">.</span>end<span class="op">()-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>            k<span class="op">--;</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">.</span>push_back<span class="op">(</span>po<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>        k<span class="op">++;</span></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>erase<span class="op">(</span>ans<span class="op">.</span>end<span class="op">()-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">long</span> <span class="dt">long</span> dist<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">){</span><span class="co">//ËÆ°ÁÆóË∑ùÁ¶ªÁöÑÂπ≥Êñπ</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>a<span class="op">-</span>b<span class="op">).</span>dot<span class="op">(</span>a<span class="op">-</span>b<span class="op">);</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rc<span class="op">(</span>vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> ans<span class="op">){</span></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tn <span class="op">=</span> ans<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> cnt<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>tn<span class="op">==</span><span class="dv">2</span><span class="op">){</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>dist<span class="op">(</span>ans<span class="op">[</span><span class="dv">0</span><span class="op">],</span>ans<span class="op">[</span><span class="dv">1</span><span class="op">])&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">,</span>j<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> k<span class="op">=</span><span class="dv">0</span><span class="op">;</span>k<span class="op">&lt;</span>tn<span class="op">;</span>k<span class="op">++){</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>cmp<span class="op">(</span>ans<span class="op">[</span>i<span class="op">],</span>ans<span class="op">[</span>k<span class="op">]))</span> i<span class="op">=</span>k<span class="op">;</span></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>cmp<span class="op">(</span>ans<span class="op">[</span>j<span class="op">],</span>ans<span class="op">[</span>k<span class="op">]))</span> j<span class="op">=</span>k<span class="op">;</span></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> si<span class="op">=</span>i<span class="op">,</span>sj<span class="op">=</span>j<span class="op">;</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>i<span class="op">!=</span>sj<span class="op">||</span>j<span class="op">!=</span>si<span class="op">){</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> max<span class="op">(</span>res<span class="op">,</span>dist<span class="op">(</span>ans<span class="op">[</span>i<span class="op">],</span>ans<span class="op">[</span>j<span class="op">]));</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">((</span>ans<span class="op">[(</span>i<span class="op">+</span><span class="dv">1</span><span class="op">)%</span>tn<span class="op">]-</span>ans<span class="op">[</span>i<span class="op">]).</span>det<span class="op">(</span>ans<span class="op">[(</span>j<span class="op">+</span><span class="dv">1</span><span class="op">)%</span>tn<span class="op">]-</span>ans<span class="op">[</span>j<span class="op">])&lt;</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>            i <span class="op">=</span> <span class="op">(</span>i<span class="op">+</span><span class="dv">1</span><span class="op">)%</span>tn<span class="op">;</span></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> <span class="op">(</span>j<span class="op">+</span><span class="dv">1</span><span class="op">)%</span>tn<span class="op">;</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>        cnt<span class="op">++;</span></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËøîÂõûÂá∏ÂåÖÊúÄËøúÁÇπÂØπÁöÑË∑ùÁ¶ªÁöÑÂπ≥Êñπ</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>res<span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> qs<span class="op">;</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>po<span class="op">[</span>i<span class="op">].</span>x<span class="op">&gt;&gt;</span>po<span class="op">[</span>i<span class="op">].</span>y<span class="op">;</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ÊåâÊ®™Á∫µÂùêÊ†áËæìÂÖ•ÁÇπÂØπ</span></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>po<span class="op">,</span>po<span class="op">+</span>n<span class="op">,</span>cmp<span class="op">);</span></span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a>    qs <span class="op">=</span> convexHull<span class="op">();</span></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>    rc<span class="op">(</span>qs<span class="op">);</span></span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="ÁªÑÂêàÊï∞Â≠¶">ÁªÑÂêàÊï∞Â≠¶</h2>
<h3 id="Âç°ÁâπÂÖ∞Êï∞">Âç°ÁâπÂÖ∞Êï∞</h3>
<p>Á¨¨<span class="math inline">\(n\)</span>‰∏™ËÆ∞‰Ωú<span
class="math inline">\(C_n\)</span></p>
<p><span
class="math inline">\(n\)</span>ÂØπÊã¨Âè∑ÂΩ¢ÊàêÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂêàÊ≥ïÁöÑÊÉÖÂÜµÊï∞ÊòØ<span
class="math inline">\(C_n\)</span></p>
<p><span class="math inline">\(n\)</span>‰∏™ËäÇÁÇπÁöÑ‰∫åÂèâÊ†ëÔºåÊÄªÂÖ±Êúâ<span
class="math inline">\(C_n\)</span>Áßç</p>
<p><span
class="math inline">\(2n+1\)</span>‰∏™ËäÇÁÇπÁªÑÊàêÁöÑÊª°‰∫åÂèâÊ†ëÔºåÊúâ<span
class="math inline">\(C_n\)</span>Áßç</p>
<p><span class="math inline">\(n\times
n\)</span>ÁöÑÊ†ºÁÇπÁΩë‰∏≠Ôºå‰ªéÂ∑¶‰∏ãËßíÊ†ºÁÇπÂá∫ÂèëÔºåÂà∞ËææÂè≥‰∏äËßíÊ†ºÁÇπÔºå‰∏çÁ©øËøáÂØπËßíÁ∫øÁöÑÂçïË∞ÉË∑ØÂæÑ‰∏™Êï∞Êúâ<span
class="math inline">\(C_n\)</span>‰∏™„ÄÇ</p>
<p>ÂÖ∂ËÆ°ÁÆóÂÖ¨Âºè‰∏∫</p>
<p><span class="math display">\[
C_n = \frac{1}{n+1}\binom{2n}{n}
\]</span></p>
<p><span class="math display">\[
C_n=\binom{2n}{n} - \binom{2n}{n-1}
\]</span></p>
<p><span class="math display">\[
C_0=1,C_{n+1}=\sum^n_{i=0}C_iC_{n-i}
\]</span></p>
<p><span class="math display">\[
C_0=1,C_{n+1}=\frac{2(2n+1)}{n+2}C_n
\]</span></p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">//ÂâçÂá†È°πÔºö1ÔºàÁ¨¨0È°πÔºâ, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">3005</span><span class="op">;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>ll h<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>ll comb<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span><span class="dt">int</span> b<span class="op">){</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    ll ans<span class="op">=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>b<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">*=</span>a<span class="op">;</span><span class="co">//Êï∞Â≠óÂ§™Â§ß‰ºöÁàÜ</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        a<span class="op">--;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>b<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">/=</span>i<span class="op">;</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>comb<span class="op">(</span><span class="dv">2</span><span class="op">*</span>i<span class="op">,</span>i<span class="op">)/(</span>i<span class="op">+</span><span class="dv">1</span><span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span><span class="st">&quot;###&quot;</span><span class="op">&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">//‰∏ãÈù¢ÊòØÈÄíÊé®Ê±ÇÊ≥ïÔºå‰∏çÂÆπÊòìÁàÜ</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    h<span class="op">[</span><span class="dv">1</span><span class="op">]=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>h<span class="op">[</span><span class="dv">1</span><span class="op">]&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">2</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        h<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> h<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]*(</span><span class="dv">4</span><span class="op">*</span>i<span class="op">-</span><span class="dv">2</span><span class="op">)/(</span>i<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        cout<span class="op">&lt;&lt;</span>h<span class="op">[</span>i<span class="op">]&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Á®≥ÂÆöÂ©öÂßªÈóÆÈ¢ò">Á®≥ÂÆöÂ©öÂßªÈóÆÈ¢ò</h3>
<h4 id="gale-shapleyÁÆóÊ≥ï">Gale-ShapleyÁÆóÊ≥ï</h4>
<div class="sourceCode" id="cb30"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">//POJ 3487</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;queue&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N   <span class="op">=</span> <span class="dv">30</span><span class="op">;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> inf <span class="op">=</span> <span class="dv">1</span><span class="op">&lt;&lt;</span><span class="dv">29</span><span class="op">;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="dv">2007</span><span class="op">;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> couple<span class="op">;</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> maleLike<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> femaleLike<span class="op">[</span>N<span class="op">][</span>N<span class="op">];</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> maleChoice<span class="op">[</span>N<span class="op">],</span>  femaleChoice<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> maleName<span class="op">[</span>N<span class="op">],</span>    femaleName<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> str<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span>freemale<span class="op">;</span><span class="co">//ÁõÆÂâçÂçïË∫´ÁöÑÁî∑‰∫∫</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t<span class="op">;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>t<span class="op">);</span><span class="co">//Êï∞ÊçÆÁªÑÊï∞</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>t<span class="op">--){</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>couple<span class="op">);</span><span class="co">//Áî∑Â•≥ÂØπÊï∞</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(!</span>freemale<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            freemale<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>couple<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span>str<span class="op">);</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>            maleName<span class="op">[</span>i<span class="op">]=</span>str<span class="op">[</span><span class="dv">0</span><span class="op">]-</span><span class="ch">&#39;a&#39;</span><span class="op">;</span><span class="co">//È¢òÁõÆ‰∏≠ÊòØ‰ª•Â∞èÂÜôÂ≠óÊØçÁªôÁî∑‰∫∫ÂêçÂ≠óÔºåËΩ¨Âåñ‰∏∫Êï∞Â≠ó</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>            freemale<span class="op">.</span>push<span class="op">(</span>maleName<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        sort<span class="op">(</span>maleName<span class="op">,</span> maleName<span class="op">+</span>couple<span class="op">);</span><span class="co">//ÂêçÂ≠óÊéíÂ∫èÔºå‰æø‰∫éÂ≠óÂÖ∏Â∫è</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>couple<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span>str<span class="op">);</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>            femaleName<span class="op">[</span>i<span class="op">]=</span>str<span class="op">[</span><span class="dv">0</span><span class="op">]-</span><span class="ch">&#39;A&#39;</span><span class="op">;</span><span class="co">//Â•≥‰∫∫ÂêçÂ≠óÊòØÂ§ßÂÜôÂ≠óÊØç</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>couple<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span>str<span class="op">);</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>couple<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>                maleLike<span class="op">[</span>i<span class="op">][</span>j<span class="op">]=</span>str<span class="op">[</span>j<span class="op">+</span><span class="dv">2</span><span class="op">]-</span><span class="ch">&#39;A&#39;</span><span class="op">;</span><span class="co">//Áî∑‰∫∫ÂñúÂ•ΩÈ°∫Â∫èÁî±Áî∑‰∫∫ÂêçÂ≠ó:Â•≥‰∫∫ÂêçÂ≠óÂàóË°®ÁªôÂá∫;ÈôçÂ∫èÊéíÂàó</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Â•≥Â£´ÂØπÁî∑Â£´ÁöÑÊâìÂàÜÔºåÊ∑ªÂä†ËôöÊãü‰∫∫Áâ©ÔºåÁºñÂè∑coupleÔºå‰∏∫Â•≥Â£´ÁöÑÂàùÂßãÂØπË±°</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>couple<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span>str<span class="op">);</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>couple<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>                femaleLike<span class="op">[</span>i<span class="op">][</span>str<span class="op">[</span>j<span class="op">+</span><span class="dv">2</span><span class="op">]-</span><span class="ch">&#39;a&#39;</span><span class="op">]=</span>couple<span class="op">-</span>j<span class="op">;</span><span class="co">//ÊéíÂêçË∂äÂâçÊâìÂàÜË∂äÈ´ò</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>            femaleLike<span class="op">[</span>i<span class="op">][</span>couple<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>maleChoice<span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="kw">sizeof</span><span class="op">(</span>maleChoice<span class="op">));</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">//‰∏ÄÂºÄÂßãÁî∑Â£´ÁöÑÊúüÊúõÈÉΩÊòØÊúÄÂñúÊ¨¢ÁöÑÂ•≥Â£´</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>couple<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>            femaleChoice<span class="op">[</span>i<span class="op">]=</span>couple<span class="op">;</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(!</span>freemale<span class="op">.</span>empty<span class="op">()){</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> male<span class="op">=</span>freemale<span class="op">.</span>front<span class="op">();</span></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>            <span class="co">//ÊâæÂá∫Êú™ÈÖçÂØπÁöÑÁî∑Â£´</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> female<span class="op">=</span>maleLike<span class="op">[</span>male<span class="op">][</span>maleChoice<span class="op">[</span>male<span class="op">]];</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>            <span class="co">//ÊâæÂá∫ÂøÉÊÑèÁöÑÂ•≥Â£´</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>femaleLike<span class="op">[</span>female<span class="op">][</span>male<span class="op">]&gt;</span>femaleLike<span class="op">[</span>female<span class="op">][</span>femaleChoice<span class="op">[</span>female<span class="op">]]){</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>            <span class="co">//ÊØîÁé∞Áî∑ÂèãÂ•Ω</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>                freemale<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span><span class="op">(</span>femaleChoice<span class="op">[</span>female<span class="op">]!=</span>couple<span class="op">){</span></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>                <span class="co">//ÂâçÁî∑ÂèãÂÜçÊ¨°ÂçïË∫´ÔºåÂπ∂‰∏î‰∏çËÉΩÂ∞ÜËôöÊãü‰∫∫Áâ©Âä†ÂÖ•ÈòüÂàó</span></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>                    freemale<span class="op">.</span>push<span class="op">(</span>femaleChoice<span class="op">[</span>female<span class="op">]);</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>                    maleChoice<span class="op">[</span>femaleChoice<span class="op">[</span>female<span class="op">]]++;</span></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>                femaleChoice<span class="op">[</span>female<span class="op">]=</span>male<span class="op">;</span></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>                <span class="co">//Êõ¥Êç¢Áî∑Âèã</span></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>                maleChoice<span class="op">[</span>male<span class="op">]++;</span></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>                <span class="co">//Â¶ÇÊûúË¢´ÊãíÁªùÔºåÂàôÈÄâÊã©‰∏ã‰∏Ä‰Ωç</span></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>couple<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%c</span><span class="st"> </span><span class="sc">%c\n</span><span class="st">&quot;</span><span class="op">,</span>maleName<span class="op">[</span>i<span class="op">]+</span><span class="ch">&#39;a&#39;</span><span class="op">,</span> maleLike<span class="op">[</span>maleName<span class="op">[</span>i<span class="op">]][</span>maleChoice<span class="op">[</span>maleName<span class="op">[</span>i<span class="op">]]]+</span><span class="ch">&#39;A&#39;</span><span class="op">);</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>t<span class="op">)</span> puts<span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="Ê†ë">Ê†ë</h2>
<h3 id="Ê†ëÁä∂Êï∞ÁªÑ">Ê†ëÁä∂Êï∞ÁªÑ</h3>
<div class="sourceCode" id="cb31"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Ê†ëÁä∂Êï∞ÁªÑ</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">500005</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bit<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">int</span> lowbit<span class="op">(</span><span class="dt">int</span> n<span class="op">){</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n<span class="op">&amp;(-</span>n<span class="op">);</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> p<span class="op">,</span> <span class="dt">int</span> k<span class="op">){</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(;</span>p<span class="op">&lt;=</span>n<span class="op">;</span>p<span class="op">+=</span>lowbit<span class="op">(</span>p<span class="op">)){</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        bit<span class="op">[</span>p<span class="op">]+=</span>k<span class="op">;</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> query<span class="op">(</span><span class="dt">int</span> p<span class="op">){</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(;</span>p<span class="op">;</span>p<span class="op">-=</span>lowbit<span class="op">(</span>p<span class="op">)){</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">+=</span>bit<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>n<span class="op">,&amp;</span>m<span class="op">);</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Êï∞ÁªÑÈïøÂ∫¶ÔºåÊü•ËØ¢Êï∞</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        update<span class="op">(</span>i<span class="op">,</span>arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> op<span class="op">;</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">,</span>y<span class="op">,</span>k<span class="op">;</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>op<span class="op">);</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>x<span class="op">);</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>op<span class="op">==</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>k<span class="op">);</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>            <span class="co">//Â∞ÜÂçïÁÇπÂ¢ûÂä†kÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÊîπÊàê‰øÆÊîπÔºåÂàôÂèØ‰ª•update(x,-arr[x]+k)</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>x<span class="op">,</span>k<span class="op">);</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span><span class="op">{</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>y<span class="op">);</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">//ËæìÂá∫[x,y]ÁöÑÊï∞ÁªÑÂíå</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>query<span class="op">(</span>y<span class="op">)-</span>query<span class="op">(</span>x<span class="op">-</span><span class="dv">1</span><span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 id="Ê†ëÁä∂Êï∞ÁªÑÊ±ÇÈÄÜÂ∫èÂØπ">Ê†ëÁä∂Êï∞ÁªÑÊ±ÇÈÄÜÂ∫èÂØπ</h4>
<div class="sourceCode" id="cb32"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Luogu P1908</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define LL </span><span class="dt">long</span><span class="pp"> </span><span class="dt">long</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">500005</span><span class="op">;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>LL arr<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>LL n<span class="op">;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Par<span class="op">{</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    LL value<span class="op">,</span>id<span class="op">;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>par<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> cmp<span class="op">(</span><span class="at">const</span> Par<span class="op">&amp;</span> a<span class="op">,</span><span class="at">const</span> Par<span class="op">&amp;</span> b<span class="op">){</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>a<span class="op">.</span>value<span class="op">!=</span>b<span class="op">.</span>value<span class="op">)</span> <span class="cf">return</span> a<span class="op">.</span>value<span class="op">&lt;</span>b<span class="op">.</span>value<span class="op">;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">.</span>id<span class="op">&lt;</span>b<span class="op">.</span>id<span class="op">;</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>LL bit<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> LL lowbit<span class="op">(</span>LL n<span class="op">){</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n<span class="op">&amp;(-</span>n<span class="op">);</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> update<span class="op">(</span>LL p<span class="op">,</span> LL k<span class="op">){</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(;</span>p<span class="op">&lt;=</span>n<span class="op">;</span>p<span class="op">+=</span>lowbit<span class="op">(</span>p<span class="op">)){</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        bit<span class="op">[</span>p<span class="op">]+=</span>k<span class="op">;</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> query<span class="op">(</span>LL p<span class="op">){</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    LL ans<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(;</span>p<span class="op">;</span>p<span class="op">-=</span>lowbit<span class="op">(</span>p<span class="op">)){</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">+=</span>bit<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">std::</span>cin<span class="op">&gt;&gt;</span>par<span class="op">[</span>i<span class="op">].</span>value<span class="op">;</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>        par<span class="op">[</span>i<span class="op">].</span>id <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>sort<span class="op">(</span>par<span class="op">+</span><span class="dv">1</span><span class="op">,</span>par<span class="op">+</span><span class="dv">1</span><span class="op">+</span>n<span class="op">,</span>cmp<span class="op">);</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>par<span class="op">[</span>i<span class="op">].</span>id<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span><span class="co">//Ëøô‰∏ÄÊ≠•ÂÖ∂ÂÆûÊòØÁ¶ªÊï£Âåñ</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>    LL ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">+=</span> query<span class="op">(</span>arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>        update<span class="op">(</span>arr<span class="op">[</span>i<span class="op">],</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> n<span class="op">*(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">)/</span><span class="dv">2</span><span class="op">-</span>ans<span class="op">;</span><span class="co">//Êú¨Êù•ÁªüËÆ°ÁöÑÊòØÁ≠â‰∫éÊàñÈ°∫Â∫èÂØπÔºåÁé∞Âú®ÂèçËøáÊù•ËÆ°ÁÆóÈÄÜÂ∫èÂØπ</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>cout<span class="op">&lt;&lt;</span>ans<span class="op">&lt;&lt;</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="Âπ∂Êü•ÈõÜ">Âπ∂Êü•ÈõÜ</h3>
<div class="sourceCode" id="cb33"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Âπ∂Êü•ÈõÜ</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">1005</span><span class="op">;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_sets<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> findf<span class="op">(</span><span class="dt">int</span> x<span class="op">){</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> find_sets<span class="op">[</span>x<span class="op">]==</span>x <span class="op">?</span> x <span class="op">:</span> find_sets<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> findf<span class="op">(</span>find_sets<span class="op">[</span>x<span class="op">]);</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> unionSet<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">){</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> findf<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> findf<span class="op">(</span>y<span class="op">);</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    find_sets<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>n<span class="op">;</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        find_sets<span class="op">[</span>i<span class="op">]=</span>i<span class="op">;</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m<span class="op">;</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    cin<span class="op">&gt;&gt;</span>m<span class="op">;</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ËæπÊï∞</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>a<span class="op">&gt;&gt;</span>b<span class="op">;</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>        find_sets<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>findf<span class="op">(</span><span class="dv">5</span><span class="op">)&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">&lt;&lt;</span>findf<span class="op">(</span><span class="dv">8</span><span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    unionSet<span class="op">(</span><span class="dv">5</span><span class="op">,</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span>findf<span class="op">(</span><span class="dv">5</span><span class="op">)&lt;&lt;</span><span class="st">&quot; &quot;</span><span class="op">&lt;&lt;</span>findf<span class="op">(</span><span class="dv">8</span><span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="co">8 6</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="co">1 2</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="co">1 3</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="co">3 4</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="co">3 5</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="co">6 7</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="co">7 8</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span></code></pre></div>
<h3 id="Á∫øÊÆµÊ†ë">Á∫øÊÆµÊ†ë</h3>
<div class="sourceCode" id="cb34"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">//luogu 3372</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> ll<span class="op">;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">100005</span><span class="op">;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>ll st<span class="op">[</span>MAXN<span class="op">*</span><span class="dv">4</span><span class="op">+</span><span class="dv">2</span><span class="op">];</span><span class="co">//ÂØπ‰∫é‰∏ÄÈ¢óÁ∫øÊÆµÊ†ëÔºån‰∏™Êï∞ÊâÄÁªÑÊàêÁöÑÊ†ëÊúÄÂ§öÊúâ4n-5‰∏™ËäÇÁÇπÔºåÂºÄÂ§ß‰∫Ü‰∏ÄÁÇπ</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>ll tag<span class="op">[</span>MAXN<span class="op">*</span><span class="dv">4</span><span class="op">+</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>ll arr<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> p<span class="op">){</span><span class="co">//Âå∫Èó¥Â∑¶Á´ØÁÇπ„ÄÅÂè≥Á´ØÁÇπ„ÄÅÂå∫Èó¥ÁºñÂè∑</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>s<span class="op">==</span>t<span class="op">){</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        st<span class="op">[</span>p<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>s<span class="op">];</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m <span class="op">=</span> s<span class="op">+((</span>t<span class="op">-</span>s<span class="op">)&gt;&gt;</span><span class="dv">1</span><span class="op">);</span><span class="co">//ÂÜôÊàê(s+t)&gt;&gt;1ÂèØËÉΩ‰ºöÁàÜ</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span>s<span class="op">,</span>m<span class="op">,</span>p<span class="op">*</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span>m<span class="op">+</span><span class="dv">1</span><span class="op">,</span>t<span class="op">,</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    st<span class="op">[</span>p<span class="op">]</span> <span class="op">=</span> st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">]+</span>st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> ll c<span class="op">){</span><span class="co">//cË°®Á§∫Âä†ÂáèÁöÑÊï∞ÂÄº</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>l<span class="op">&lt;=</span>s<span class="op">&amp;&amp;</span>t<span class="op">&lt;=</span>r<span class="op">){</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        st<span class="op">[</span>p<span class="op">]+=(</span>t<span class="op">-</span>s<span class="op">+</span><span class="dv">1</span><span class="op">)*</span>c<span class="op">;</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">]+=</span>c<span class="op">;</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    ll m <span class="op">=</span> s <span class="op">+</span> <span class="op">((</span>t<span class="op">-</span>s<span class="op">)&gt;&gt;</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>tag<span class="op">[</span>p<span class="op">]&amp;&amp;</span>s<span class="op">!=</span>t<span class="op">){</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">]</span>   <span class="op">+=</span> <span class="op">(</span>m<span class="op">-</span>s<span class="op">+</span><span class="dv">1</span><span class="op">)*</span>tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> <span class="op">(</span>t<span class="op">-</span>m<span class="op">)*</span>tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">]</span>  <span class="op">+=</span> tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">]+=</span> tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>l<span class="op">&lt;=</span>m<span class="op">)</span> update<span class="op">(</span>l<span class="op">,</span> r<span class="op">,</span> s<span class="op">,</span> m<span class="op">,</span> p<span class="op">*</span><span class="dv">2</span><span class="op">,</span> c<span class="op">);</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>r<span class="op">&gt;</span>m<span class="op">)</span>  update<span class="op">(</span>l<span class="op">,</span> r<span class="op">,</span> m<span class="op">+</span><span class="dv">1</span><span class="op">,</span> t<span class="op">,</span> p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">,</span> c<span class="op">);</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    st<span class="op">[</span>p<span class="op">]</span> <span class="op">=</span> st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span> st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>ll query<span class="op">(</span><span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> p<span class="op">){</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Êü•ËØ¢[l,r]ÁöÑÂíå</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>l<span class="op">&lt;=</span>s<span class="op">&amp;&amp;</span>t<span class="op">&lt;=</span>r<span class="op">){</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> st<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    ll sum<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>    ll m <span class="op">=</span> s<span class="op">+((</span>t<span class="op">-</span>s<span class="op">)&gt;&gt;</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>tag<span class="op">[</span>p<span class="op">]){</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>        st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">]</span>   <span class="op">+=</span> <span class="op">(</span>m<span class="op">-</span>s<span class="op">+</span><span class="dv">1</span><span class="op">)*</span>tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>        st<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> <span class="op">(</span>t<span class="op">-</span>m<span class="op">)*</span>tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">]</span>  <span class="op">+=</span> tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">]+=</span> tag<span class="op">[</span>p<span class="op">];</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>        tag<span class="op">[</span>p<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>l<span class="op">&lt;=</span>m<span class="op">)</span> sum<span class="op">+=</span>query<span class="op">(</span>l<span class="op">,</span>r<span class="op">,</span>s<span class="op">,</span>m<span class="op">,</span>p<span class="op">*</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>r<span class="op">&gt;</span>m<span class="op">)</span>  sum<span class="op">+=</span>query<span class="op">(</span>l<span class="op">,</span>r<span class="op">,</span>m<span class="op">+</span><span class="dv">1</span><span class="op">,</span>t<span class="op">,</span>p<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>n<span class="op">,&amp;</span>m<span class="op">);</span></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Êï∞ÁªÑÈïøÂ∫¶ÔºåÊü•ËØ¢Ê¨°Êï∞</span></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%ld</span><span class="st">&quot;</span><span class="op">,&amp;</span>arr<span class="op">[</span>i<span class="op">]);</span>   </span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span><span class="dv">1</span><span class="op">,</span>n<span class="op">,</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> ope<span class="op">;</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>        cin<span class="op">&gt;&gt;</span>ope<span class="op">;</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>ope<span class="op">==</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> x<span class="op">,</span>y<span class="op">,</span>z<span class="op">;</span></span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>x<span class="op">,&amp;</span>y<span class="op">,&amp;</span>z<span class="op">);</span></span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>            <span class="co">//[x,y]Âä†‰∏äz</span></span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>            update<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> z<span class="op">);</span></span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span><span class="op">{</span></span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>x<span class="op">,&amp;</span>y<span class="op">);</span></span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>            <span class="co">//Êü•ËØ¢[x,y]ÁöÑÂíå</span></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>            cout<span class="op">&lt;&lt;</span>query<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> <span class="dv">1</span><span class="op">)&lt;&lt;</span>endl<span class="op">;</span></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="ÂÄçÂ¢û">ÂÄçÂ¢û</h2>
<h3 id="stË°®">STË°®</h3>
<p>ÂØπ‰∫éÁªèÂÖ∏ÁöÑRMQÔºàÂç≥ÁªôÂÆö‰∏Ä‰∏™Êï∞ÁªÑÔºåÊ±ÇÂå∫Èó¥ÂÜÖÁöÑÊúÄÂ§ßÂÄºÔºâÈóÆÈ¢òÔºåÊúâÂ¶Ç‰∏ã‰ª£Á†Å</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">//luogu P3865</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">100005</span><span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> LOGN <span class="op">=</span> <span class="dv">21</span><span class="op">;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fmax<span class="op">[</span>MAXN<span class="op">][</span>LOGN<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">//fmax[a][b]Ë°®Á§∫[a,a+2^b-1]‰∏≠ÁöÑÊúÄÂ§ßÂÄº</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> logn<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">//È¢ÑÂÖàËÆ°ÁÆólogn</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">;</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Êï∞ÁªÑÂ§ßÂ∞è‰ª•ÂèäÊü•ËØ¢Ê¨°Êï∞</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>n<span class="op">,&amp;</span>m<span class="op">);</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>fmax<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    logn<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    logn<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">3</span><span class="op">;</span>i<span class="op">&lt;</span>MAXN<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>        logn<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> logn<span class="op">[</span>i<span class="op">/</span><span class="dv">2</span><span class="op">]+</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">//È¢ÑÂÖàËÆ°ÁÆólogn</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>LOGN<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">+(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>j<span class="op">)-</span><span class="dv">1</span><span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>            fmax<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="bu">std::</span>max<span class="op">(</span>fmax<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">],</span>fmax<span class="op">[</span>i<span class="op">+(</span><span class="dv">1</span><span class="op">&lt;&lt;(</span>j<span class="op">-</span><span class="dv">1</span><span class="op">))][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>a<span class="op">,&amp;</span>b<span class="op">);</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Êü•ËØ¢[a,b]ÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºåÂç≥[a,a+2^s-1]‰∏é[b-2^s+1,b]</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> s <span class="op">=</span> logn<span class="op">[</span>b<span class="op">-</span>a<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span><span class="bu">std::</span>max<span class="op">(</span>fmax<span class="op">[</span>a<span class="op">][</span>s<span class="op">],</span>fmax<span class="op">[</span>b<span class="op">-(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>s<span class="op">)+</span><span class="dv">1</span><span class="op">][</span>s<span class="op">]));</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="ÂÄçÂ¢ûÊ±ÇÊúÄËøëÂÖ¨ÂÖ±Á•ñÂÖà">ÂÄçÂ¢ûÊ±ÇÊúÄËøëÂÖ¨ÂÖ±Á•ñÂÖà</h3>
<div class="sourceCode" id="cb36"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">//luogu P3379</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="dv">500005</span><span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> LOGN <span class="op">=</span> <span class="dv">31</span><span class="op">;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> edge<span class="op">[</span>MAXN<span class="op">];</span><span class="co">//ÈÇªÊé•Ë°®</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fa<span class="op">[</span>MAXN<span class="op">][</span>LOGN<span class="op">],</span>deep<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">//fa[a][b]‰ª£Ë°®aÁöÑÁ¨¨2^b‰∏™Á•ñÂÖàÔºådeepÊòØÊ∑±Â∫¶ÔºåÊ†πËäÇÁÇπÊ∑±Â∫¶‰∏∫1</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> v<span class="op">,</span><span class="dt">int</span> father<span class="op">){</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    fa<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> father<span class="op">;</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    deep<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> deep<span class="op">[</span>father<span class="op">]+</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>LOGN<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        fa<span class="op">[</span>v<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> fa<span class="op">[</span>fa<span class="op">[</span>v<span class="op">][</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]][</span>i<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> v1<span class="op">:</span>edge<span class="op">[</span>v<span class="op">]){</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>v1<span class="op">==</span>father<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>v1<span class="op">,</span>v<span class="op">);</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> lca<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span><span class="dt">int</span> y<span class="op">){</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>deep<span class="op">[</span>x<span class="op">]&gt;</span>deep<span class="op">[</span>y<span class="op">])</span> <span class="bu">std::</span>swap<span class="op">(</span>x<span class="op">,</span>y<span class="op">);</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">//‰øùËØÅyÊØîxÊ∑±</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tmp <span class="op">=</span> deep<span class="op">[</span>y<span class="op">]-</span>deep<span class="op">[</span>x<span class="op">];</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>tmp<span class="op">;</span>i<span class="op">++,</span>tmp<span class="op">&gt;&gt;=</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>tmp<span class="op">&amp;</span><span class="dv">1</span><span class="op">)</span> y<span class="op">=</span>fa<span class="op">[</span>y<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>x<span class="op">==</span>y<span class="op">)</span> <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span>LOGN<span class="op">-</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&gt;=</span><span class="dv">0</span><span class="op">&amp;&amp;</span>y<span class="op">!=</span>x<span class="op">;</span>i<span class="op">--){</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>fa<span class="op">[</span>x<span class="op">][</span>i<span class="op">]!=</span>fa<span class="op">[</span>y<span class="op">][</span>i<span class="op">]){</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> fa<span class="op">[</span>x<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> fa<span class="op">[</span>y<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fa<span class="op">[</span>y<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span>m<span class="op">,</span>s<span class="op">;</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>n<span class="op">,&amp;</span>m<span class="op">,&amp;</span>s<span class="op">);</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">//ÁÇπÊï∞ÔºåËØ¢ÈóÆÊï∞ÔºåÊ†πËäÇÁÇπÂ∫èÂè∑</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">-</span><span class="dv">1</span><span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>a<span class="op">,&amp;</span>b<span class="op">);</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">//ËØªÂÖ•Ê†ë</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>        edge<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>        edge<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    build<span class="op">(</span>s<span class="op">,</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>m<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">,</span>y<span class="op">;</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>        scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,&amp;</span>x<span class="op">,&amp;</span>y<span class="op">);</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">//Êü•ËØ¢x,yÁöÑÊúÄËøëÂÖ¨ÂÖ±Á•ñÂÖà</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span>lca<span class="op">(</span>x<span class="op">,</span>y<span class="op">));</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="‰∫åÂàÜ">‰∫åÂàÜ</h2>
<h3 id="‰∫åÂàÜÁ≠îÊ°à">‰∫åÂàÜÁ≠îÊ°à</h3>
<p>ÁªôÂá∫‰∏Ä‰∏™ÈÄöÁî®‰ª£Á†Å</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> l <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> r <span class="op">=</span> MAXR<span class="op">;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span><span class="op">(</span>l<span class="op">+</span><span class="dv">1</span><span class="op">&lt;</span>r<span class="op">){</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l<span class="op">+</span>r<span class="op">)&gt;&gt;</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>judge<span class="op">(</span>mid<span class="op">))</span> l<span class="op">=</span>mid<span class="op">;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> r <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span>judge<span class="op">(</span>l<span class="op">))</span> <span class="bu">std::</span>cout<span class="op">&lt;&lt;</span>l<span class="op">&lt;&lt;</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="bu">std::</span>cout<span class="op">&lt;&lt;</span>r<span class="op">&lt;&lt;</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span></code></pre></div>
<p>judgeÂáΩÊï∞Â∫îËØ•Ê†πÊçÆÈ¢òÊÑèÂÜôÂá∫„ÄÇ</p>
<p>Â¶ÇÊûúÊòØÊµÆÁÇπÊï∞ÁöÑ‰∫åÂàÜÔºåÂàô‰∏çÊé®Ëçê‰ΩøÁî®EPSËøõË°åÁ≤æÂ∫¶Âà§Êñ≠ÔºàÊúâÂèØËÉΩ‰ºö‰∏¢Á≤æÂ∫¶Ôºâ„ÄÇËÄåÊòØ‰ΩøÁî®ËÆ°Êï∞Âô®Ôºå‰∏ÄËà¨Ëø≠‰ª£100Ê¨°Â∞±ËÉΩ‰øùËØÅÁ¨¶ÂêàÈ¢òÁõÆË¶ÅÊ±Ç„ÄÇ</p>
<h2 id="Ê¶ÇÁéáËÆ∫">Ê¶ÇÁéáËÆ∫</h2>
<h3 id="Â§ÑÁêÜÂàÜÊï∞ÊúüÊúõÊ¶ÇÁéá">Â§ÑÁêÜÂàÜÊï∞ÊúüÊúõ„ÄÅÊ¶ÇÁéá</h3>
<p>ÊúâÊó∂ÂÄôÔºåÈ¢òÁõÆ‰∏≠ÁöÑÊúüÊúõÊòØ‰∏Ä‰∏™ÂàÜÊï∞<span
class="math inline">\(\frac{P}{Q}\)</span>ÔºåËÄå‰∏∫‰∫ÜÈò≤Ê≠¢Á≤æÂ∫¶ÈóÆÈ¢òÔºåÂæÄÂæÄ‰ºöË¶ÅÊ±ÇËæìÂá∫‰∏Ä‰∏™<span
class="math inline">\(R\)</span>ÔºåÊª°Ë∂≥</p>
<p><span class="math display">\[
R\times Q\equiv P(mod\ 998244353)
\]</span></p>
<p>Ê≠§Êó∂</p>
<p><span class="math display">\[
R = (P\times Q^{-1})\%998244353
\]</span></p>
<p><span class="math inline">\(Q^{-1}\)</span>ÊòØ<span
class="math inline">\(Q\)</span>Âú®Ê®°<span
class="math inline">\(998244353\)</span>ÊÑè‰πâ‰∏ãÁöÑ‰πòÊ≥ïÈÄÜÂÖÉ</p>
<h2 id="c-stlÁî®Ê≥ï">C++ STLÁî®Ê≥ï</h2>
<h3 id="stdswap">std::swap</h3>
<p>‰∫§Êç¢‰∏§‰∏™ÂÖÉÁ¥†ÁöÑÂÜÖÂÆπÔºà‰πüÂèØ‰ª•‰∫§Êç¢Êï∞ÁªÑÔºå‰∏çÈáçË¶Å‰∏ç‰ªãÁªçÔºâ„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞„ÄÇ</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">,</span>b<span class="op">;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>swap<span class="op">(</span>a<span class="op">,</span>b<span class="op">);</span></span></code></pre></div>
<p>Ê≥®ÊÑèÂÖ∂‰∏≠ÁöÑ‰∏§‰∏™ÂèÇÊï∞ÔºåÁ±ªÂûãË¶ÅÁõ∏Âêå„ÄÇ‰∏çËÉΩ‰∏Ä‰∏™ÊòØLL‰∏Ä‰∏™ÊòØint„ÄÇ</p>
<h3 id="stdsort">std::sort</h3>
<p>ÂØπÊï∞ÁªÑ„ÄÅvectorÁ≠âËøõË°åÊéíÂ∫è„ÄÇÂ§çÊùÇÂ∫¶nlogn„ÄÇ</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> vec<span class="op">(</span><span class="dv">5</span><span class="op">);</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>sort<span class="op">(</span>a<span class="op">,</span>a<span class="op">+</span><span class="dv">5</span><span class="op">);</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>sort<span class="op">(</span>vec<span class="op">.</span>begin<span class="op">(),</span>vec<span class="op">.</span>end<span class="op">());</span></span></code></pre></div>
<p>Ê≥®ÊÑèÊéíÂ∫èËåÉÂõ¥ÊòØÂ∑¶Èó≠Âè≥ÂºÄÂå∫Èó¥„ÄÇ</p>
<p>ÈÄöÂ∏∏‰ºöÊåâÁÖßÁ±ªÂûãÁöÑ&lt;Êìç‰ΩúÁ¨¶Êù•ËøõË°åÊØîËæÉ„ÄÇÂ¶ÇÊûúÂØπÁªìÊûÑ‰ΩìËøõË°åÊéíÂ∫èÔºåÂèØ‰ª•ÈáçËΩΩËøêÁÆóÁ¨¶ÊàñËÄÖËÆæÂÆöcmpÂáΩÊï∞„ÄÇÊ≥®ÊÑèËøô‰∏§ÁßçÊñπÊ≥ï‰∏ÄÂÆö‰∏çËÉΩÊòØÂ∞è‰∫éÁ≠â‰∫éÊàñËÄÖÂ§ß‰∫éÁ≠â‰∫éÁöÑËøêÁÆóÔºåÂøÖÈ°ªÂè™‰ΩøÁî®Â∞è‰∫éÂè∑ÊàñËÄÖÂ§ß‰∫éÂè∑Ôºà‰∏•Ê†ºÂº±Â∫èÔºâ„ÄÇ</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> cmp<span class="op">(</span><span class="at">const</span> Type1<span class="op">&amp;</span> a<span class="op">,</span> <span class="at">const</span> Type2<span class="op">&amp;</span> b<span class="op">);</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">//ÁÑ∂ÂêéÂú®sort‰∏≠Âä†ÂÖ•Á¨¨‰∏â‰∏™ÂèÇÊï∞</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>sort<span class="op">(</span>a<span class="op">,</span>a<span class="op">+</span><span class="dv">5</span><span class="op">,</span>cmp<span class="op">);</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> node<span class="op">{</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;(</span><span class="at">const</span> node<span class="op">&amp;</span> a<span class="op">);</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">//‰∏çÁî®Ê∑ªÂä†cmpÂèÇÊï∞</span></span></code></pre></div>
<h3
id="stdlower_boundstdupper_bound">std::lower_bound,std::upper_bound</h3>
<p>ÂØπÊüê‰∏™Â∑≤ÁªèÊéíÂ∫èÂ•ΩÁöÑÊï∞ÁªÑÔºåÊü•ÊâæÁ¨¨‰∏Ä‰∏™Â§ß‰∫éÁ≠â‰∫éÔºàlower_boundÔºâÊàñËÄÖÂ§ß‰∫é(upper_bound)Êüê‰∏™ÁªôÂÆöÂÄºÁöÑÂÖÉÁ¥†„ÄÇÂ§çÊùÇÂ∫¶Ôºölogn„ÄÇ</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">[</span><span class="dv">5</span><span class="op">]={</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">6</span><span class="op">};</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> first <span class="op">=</span> <span class="bu">std::</span>lower_bound<span class="op">(</span>a<span class="op">,</span>a<span class="op">+</span><span class="dv">5</span><span class="op">,</span><span class="dv">3</span><span class="op">);</span></span></code></pre></div>
<p>ÂêåÊ†∑ÊòØÂ∑¶Èó≠Âè≥ÂºÄÂå∫Èó¥ÔºåÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÊòØÊåáÂÆöÁöÑÂÄº„ÄÇÂ¶ÇÊûúÊâæÂà∞Â∞±‰ºöËøîÂõûÊâÄÊü•ÊâæÂÖÉÁ¥†ÁöÑËø≠‰ª£Âô®ÔºàÊàñËÄÖÊåáÈíàÔºâ„ÄÇÊâæ‰∏çÂà∞Â∞±‰ºöËøîÂõûÊú´Â∞æÂÖÉÁ¥†ÁöÑÂêé‰∏Ä‰∏™ÊåáÈíàÔºàÊàñËÄÖendËø≠‰ª£Âô®Ôºâ„ÄÇ</p>
<p>Â¶ÇÊûúÈúÄË¶ÅËá™ÂÆö‰πâÊØîËæÉÊñπÊ≥ïÔºåÂêåsortÂáΩÊï∞„ÄÇ</p>
<h3 id="stdmaxstdmin">std::max,std::min</h3>
<p>ÂØπ‰∫é‰∏§‰∏™ÂÖÉÁ¥†ËøîÂõûÊúÄÂ§ßÂÄºÂíåÊúÄÂ∞èÂÄº„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂáÜÁ°Æ‰∏ÄÊ¨°ÊØîËæÉ„ÄÇ</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">=</span><span class="dv">1</span><span class="op">,</span>b<span class="op">=</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> maxv <span class="op">=</span> <span class="bu">std::</span>max<span class="op">(</span>a<span class="op">,</span>b<span class="op">);</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> minv <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(</span>a<span class="op">,</span>b<span class="op">);</span></span></code></pre></div>
<p>ÂêåÊ†∑Ôºå‰∏§‰∏™ÂèÇÊï∞Á±ªÂûãÁõ∏Âêå„ÄÇËá™ÂÆö‰πâÊØîËæÉÊñπÊ≥ïÂêåsort„ÄÇ</p>
<h3 id="stdabs">std::abs</h3>
<p>ËÆ°ÁÆóÁªùÂØπÂÄº„ÄÇÂ§çÊùÇÂ∫¶ÔºöÊñáÊ°£Ê≤°ÂÜô‰ΩÜÂ∫îËØ•ÊòØÂ∏∏Êï∞„ÄÇ</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> b <span class="op">=</span> <span class="bu">std::</span>abs<span class="op">(</span>a<span class="op">);</span></span></code></pre></div>
<p>Ê≥®ÊÑèÔºåÂáΩÊï∞Âè™Êúâfloat,double,long
doubleÁöÑËøîÂõûÂÄºÁ±ªÂûã„ÄÇ‰ΩøÁî®Êó∂Â¶ÇÊûúÁªô‰∫àÊï¥Êï∞ÂèÇÊï∞‰ºöËá™Âä®ËΩ¨Êç¢ÔºåËøôÊòØÂê¶‰ºöÂØºËá¥Á≤æÂ∫¶ÈóÆÈ¢òÊúâÂæÖËßÇÂØü„ÄÇ</p>
<h3 id="stdstring">std::string</h3>
<h4 id="swap">::swap</h4>
<p>Â∞Ü‰∏§‰∏™Â≠óÁ¨¶‰∏≤‰∫íÊç¢„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞„ÄÇ</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>string<span class="op"> </span>str <span class="op">=</span> <span class="st">&quot;123456&quot;</span><span class="op">;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>string<span class="op"> </span>str2 <span class="op">=</span> <span class="st">&quot;456789&quot;</span><span class="op">;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>str<span class="op">.</span>swap<span class="op">(</span>str2<span class="op">);</span></span></code></pre></div>
<h4 id="beginstdend">::begin,std::end</h4>
<p>ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑËµ∑ÂßãÂæóÂ∏¶Âô®ÂíåÁªìÂ∞æËø≠‰ª£Âô®„ÄÇ</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>str<span class="op">.</span>begin<span class="op">();</span>str<span class="op">.</span>end<span class="op">();</span></span></code></pre></div>
<h4 id="size">::size</h4>
<p>ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÂ§ßÂ∞è„ÄÇ</p>
<div class="sourceCode" id="cb46"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>str<span class="op">.</span>size<span class="op">();</span></span></code></pre></div>
<h4 id="push_back">::push_back</h4>
<p>ÂêëÂ≠óÁ¨¶‰∏≤Êú´Â∞æÊ∑ªÂä†‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÂêåÊó∂Â§ßÂ∞èÂä†‰∏Ä„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞„ÄÇ</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>str<span class="op">.</span>push_back<span class="op">(</span><span class="ch">&#39;a&#39;</span><span class="op">);</span></span></code></pre></div>
<h4 id="pop_back">::pop_back</h4>
<p>Â∞ÜÂ≠óÁ¨¶‰∏≤Êú´Â∞æÁöÑÂ≠óÁ¨¶ÂºπÂá∫ÔºåÂêåÊó∂Â§ßÂ∞èÂáè‰∏Ä„ÄÇÂ¶ÇÊûúÂ≠óÁ¨¶‰∏≤‰∏∫Á©∫ÂàôÊú™ÂÆö‰πâ„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞„ÄÇ</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>str<span class="op">.</span>pop_back<span class="op">();</span></span></code></pre></div>
<h4 id="find">::find</h4>
<p>Âú®Â≠óÁ¨¶‰∏≤‰∏≠ÂØªÊâæÊüê‰∏™Â≠ê‰∏≤ÊòØÂê¶Â≠òÂú®„ÄÇÂ§çÊùÇÂ∫¶ÔºöÊ≤°ÊúâËßÑÂÆöÔºåÁºñËØëÂô®‰∏ç‰∏ÄÂÆöÈÉΩÊòØ‰ΩøÁî®ÁöÑkmpÁÆóÊ≥ï„ÄÇ</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>string<span class="bu">::</span>size_type<span class="op"> </span>n<span class="op">;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>string<span class="op"> </span>s <span class="op">=</span> <span class="st">&quot;this is a string&quot;</span><span class="op">;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> s<span class="op">.</span>find<span class="op">(</span><span class="st">&quot;is&quot;</span><span class="op">);</span></span></code></pre></div>
<p>Â¶ÇÊûúÊâæÂà∞ÂàôËøîÂõûÈ¶ñ‰∏™ÂåπÈÖçÁöÑÈ¶ñÂ≠óÊØç‰ΩçÁΩÆ„ÄÇÂê¶ÂàôËøîÂõûstd::string::npos„ÄÇÂ¶ÇÊûúÊòØint
n‰Ωú‰∏∫s.findÁöÑÊé•Êî∂Á´ØÔºåÂàô‰ºöÂú®Êâæ‰∏çÂà∞Êó∂Êé•Êî∂Âà∞-1„ÄÇ</p>
<h3 id="stdmemset">std::memset</h3>
<p>Â∞ÜÂÄºÂ§çÂà∂Âà∞destÊâÄÊåáÂØπË±°ÁöÑÂâçcount‰∏™Â≠óËäÇ‰∏≠„ÄÇÂ§çÊùÇÂ∫¶ÔºöÊ≤°ÊúâËßÑÂÆö„ÄÇ</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">[</span><span class="dv">20</span><span class="op">];</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>memset<span class="op">(</span>a<span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="kw">sizeof</span><span class="op">(</span>a<span class="op">));</span></span></code></pre></div>
<p>Ê≥®ÊÑèÔºåËµãÁöÑÂÄº‰∏çËÉΩÈöè‰æøÂèñÔºåËøô‰∏™ÂáΩÊï∞ÊòØ‰∏Ä‰∏™Â≠óËäÇ‰∏Ä‰∏™Â≠óËäÇÂú∞ÂéªËµãÂÄºÁöÑ„ÄÇÂ¶ÇÊûúÂèñ1Âπ∂‰∏ç‰ºöÂæóÂà∞ÂÖ®ÈÉ®ËµãÂÄº‰∏∫1ÁöÑÊïàÊûúÔºåÈÄöÂ∏∏Âè™‰ºöÂèñ0Âíå-1„ÄÇ</p>
<h3 id="stdmap">std::map</h3>
<p>mapÊòØÊúâÂ∫èÈîÆÂÄºÂØπÂÆπÂô®ÔºåÈÄöÂ∏∏Áî®Á∫¢ÈªëÊ†ëÂÆûÁé∞„ÄÇÂÖÉÁ¥†ÁöÑÈîÆÊòØÂîØ‰∏ÄÁöÑ„ÄÇ</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Key<span class="op">,</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> T<span class="op">,</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Compare <span class="op">=</span> <span class="bu">std::</span>less<span class="op">&lt;</span>Key<span class="op">&gt;,</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Allocator <span class="op">=</span> <span class="bu">std::</span>allocator<span class="op">&lt;</span><span class="bu">std::</span>pair<span class="op">&lt;</span><span class="at">const</span> Key<span class="op">,</span> T<span class="op">&gt;</span> <span class="op">&gt;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="kw">class</span> map<span class="op">;</span></span></code></pre></div>
<p>ÂèØ‰ª•ÈÄöËøáËø≠‰ª£Âô®Êù•ÈÅçÂéÜ</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="bu">std::</span>map<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;::</span>iterator it <span class="op">=</span> mp<span class="op">.</span>begin<span class="op">();</span>it<span class="op">!=</span>mp<span class="op">.</span>end<span class="op">();</span>it<span class="op">++);</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">//ËÆøÈóÆÂÖÉÁ¥†Áî®it-&gt;firstÂíåit-&gt;second</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">//ÊàñËÄÖ</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> it<span class="op">:</span>mp<span class="op">);</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">//ËÆøÈóÆÂÖÉÁ¥†Áî®it.firstÂíåit.second</span></span></code></pre></div>
<h4 id="Ëá™ÂÆö‰πâÊØîËæÉÂáΩÊï∞">Ëá™ÂÆö‰πâÊØîËæÉÂáΩÊï∞</h4>
<p>mapÈÄöÂ∏∏‰ºöÊåâÁÖßkeyÁöÑÂ§ßÂ∞èÂÖ≥Á≥ªËøõË°åÂçáÂ∫èÊéíÂàó„ÄÇÂ¶ÇÊûúË¶ÅËá™ÂÆö‰πâÊØîËæÉÂáΩÊï∞ÔºåÂàô</p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> cmp<span class="op">{</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="kw">operator</span><span class="op">()(</span><span class="at">const</span> <span class="dt">int</span><span class="op">&amp;</span> a<span class="op">,</span> <span class="at">const</span> <span class="dt">int</span><span class="op">&amp;</span> b<span class="op">)</span> <span class="at">const</span><span class="op">{</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">&gt;</span>b<span class="op">;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>map<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="bu">std::</span>string<span class="op">,</span>cmp<span class="op">&gt;</span> mp<span class="op">;</span></span></code></pre></div>
<h4 id="empty">::empty</h4>
<p>Ê£ÄÊµãÊòØÂê¶‰∏∫Á©∫„ÄÇ</p>
<h4 id="size-1">::size</h4>
<p>ËøîÂõûÂ§ßÂ∞è„ÄÇ</p>
<h4 id="clear">::clear</h4>
<p>Ê∏ÖÈô§ÊâÄÊúâÂÜÖÂÆπ„ÄÇÂ§çÊùÇÂ∫¶ÔºöÁ∫øÊÄß„ÄÇ</p>
<h4 id="erase">::erase</h4>
<p>Êèê‰æõËø≠‰ª£Âô®ÔºåÂà†Èô§Ëø≠‰ª£Âô®ÊâÄÊåáÁöÑÈîÆÂÄºÂØπ„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞„ÄÇ</p>
<div class="sourceCode" id="cb54"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> it <span class="op">=</span> mp<span class="op">.</span>begin<span class="op">();</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>mp<span class="op">.</span>erase<span class="op">(</span>it<span class="op">);</span></span></code></pre></div>
<h4 id="find-1">::find</h4>
<p>ÂØªÊâækeyÁ≠â‰∫éÁªôÂÆöÂÄºÁöÑÂÖÉÁ¥†ÔºåËøîÂõûËø≠‰ª£Âô®„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÂàôËøîÂõûendËø≠‰ª£Âô®„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂØπÊï∞„ÄÇ</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> it <span class="op">=</span> mp<span class="op">.</span>find<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span></code></pre></div>
<h4 id="lower_boundupper_bound">::lower_bound,::upper_bound</h4>
<p>ÂØªÊâæÈ¶ñ‰∏™Â§ß‰∫éÁ≠â‰∫é(ÊàñÂ§ß‰∫éÔºåÂØπupper_bound)ÁªôÂÆöÂÄºÁöÑkey„ÄÇÂ§çÊùÇÂ∫¶ÔºöÂØπÊï∞„ÄÇ</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> it <span class="op">=</span> mp<span class="op">.</span>lower_bound<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span></code></pre></div>
<h3 id="stdunordered_map">std::unordered_map</h3>
<p>ÂèØ‰ª•Áúã‰ΩúÊòØÊó†Â∫èÁöÑmapÔºåÈÄöÂ∏∏Áî±ÂìàÂ∏åË°®ÂÆûÁé∞„ÄÇËøôÊÑèÂë≥ÁùÄmap‰∏≠ÂíåÊéíÂ∫èÊúâÂÖ≥ÁöÑÂáΩÊï∞ÈÉΩ‰∏çËÉΩ‰ΩøÁî®„ÄÇ</p>
<h3 id="stdset">std::set</h3>
<p>setÊòØÂÖ≥ËÅîÂÆπÂô®ÔºåÂê´ÊúâKeyÁ±ªÂûãÂØπË±°ÁöÑÂ∑≤ÊéíÂ∫èÈõÜÔºåÈÄöÂ∏∏Áî®Á∫¢ÈªëÊ†ëÂÆûÁé∞„ÄÇ</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">template</span><span class="op">&lt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Key<span class="op">,</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Compare <span class="op">=</span> <span class="bu">std::</span>less<span class="op">&lt;</span>Key<span class="op">&gt;,</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Allocator <span class="op">=</span> <span class="bu">std::</span>allocator<span class="op">&lt;</span>Key<span class="op">&gt;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="kw">class</span> set<span class="op">;</span></span></code></pre></div>
<p>ÈÅçÂéÜÁöÑÊñπÂºè‰∏émapÁõ∏Âêå„ÄÇ</p>
<h4 id="‰ΩøÁî®ÊñπÊ≥ï">‰ΩøÁî®ÊñπÊ≥ï</h4>
<p>Ëá™ÂÆö‰πâÊØîËæÉÂáΩÊï∞,empty,size,clear,erase,find,lower_bound,upper_boundÈÉΩ‰∏émapÁõ∏Âêå„ÄÇ</p>
<h3 id="stdunordered_set">std::unordered_set</h3>
<p>Áî®ÂìàÂ∏åÂÆûÁé∞ÔºåÊ≤°ÊúâÂÜÖÈÉ®ÊéíÂ∫è„ÄÇ</p>
<h3 id="stdstack">std::stack</h3>
<p>Ê†àÔºåÊúâÂÖàÂÖ•ÂêéÂá∫ÁâπÊÄß„ÄÇ</p>
<h4 id="top">::top</h4>
<p>ËÆøÈóÆÊ†àÈ°∂ÂÖÉÁ¥†ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞„ÄÇ</p>
<h4 id="empty-1">::empty</h4>
<p>Ê£ÄÊü•ÊòØÂê¶‰∏∫Á©∫ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="size-2">::size</h4>
<p>ËøîÂõûÂÖÉÁ¥†‰∏™Êï∞ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="push">::push</h4>
<p>Â∞ÜÂÖÉÁ¥†Êé®ÂÖ•Ê†àÔºåÂ§çÊùÇÂ∫¶ÔºöÈÄöÂ∏∏ÂíådequeÁöÑpush_backÁõ∏ÂêåÔºåÂç≥Â∏∏Êï∞</p>
<h4 id="pop">::pop</h4>
<p>Â∞ÜÊ†àÈ°∂ÂºπÂá∫ÔºåÂ§çÊùÇÂ∫¶ÔºöÈÄöÂ∏∏ÂíådequeÁöÑpop_backÁõ∏ÂêåÔºåÂç≥Â∏∏Êï∞</p>
<h4 id="emplace">::emplace</h4>
<p>Âú®È°∂ÈÉ®Âéü‰ΩçÊûÑÈÄ†ÂÖÉÁ¥†ÔºåÈÄöÂ∏∏‰ºöÁî®Âú®Ê†àÁöÑÂÖÉÁ¥†ÊòØÁªìÊûÑ‰ΩìÁöÑÊó∂ÂÄôÔºåÂ§çÊùÇÂ∫¶ÔºöÈÄöÂ∏∏ÂíådequeÁöÑemplace_backÁõ∏ÂêåÔºåÂç≥Â∏∏Êï∞</p>
<h3 id="stdqueue">std::queue</h3>
<p>ÈòüÂàóÔºåÊã•ÊúâÂÖàÂÖ•ÂÖàÂá∫ÁâπÊÄß„ÄÇ</p>
<h4 id="front">::front</h4>
<p>ËÆøÈóÆÈòüÈ¶ñÂÖÉÁ¥†ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="back">::back</h4>
<p>ËÆøÈóÆÈòüÂ∞æÂÖÉÁ¥†ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="ÂÖ∂‰ªñÊñπÊ≥ï">ÂÖ∂‰ªñÊñπÊ≥ï</h4>
<p>ÂêåstackÔºå‰∏çËøápushÊòØÊé®ÂÖ•ÈòüÂ∞æÔºåpopÊòØÂºπÂá∫ÈòüÈ¶ñ„ÄÇ</p>
<h3 id="stdpriority_queue">std::priority_queue</h3>
<p>‰ºòÂÖàÈòüÂàóÔºåÊèê‰æõÂ∏∏Êï∞Êó∂Èó¥ÁöÑÊúÄÂ§ßÔºàÊàñÊúÄÂ∞èÔºâÂÖÉÁ¥†Êü•ÊâæÔºå‰ª•ÂèäÂØπÊï∞Êó∂Èó¥ÁöÑÊèíÂÖ•‰∏éÂà†Èô§„ÄÇ</p>
<h4 id="Ëá™ÂÆö‰πâÊØîËæÉÊñπÊ≥ï">Ëá™ÂÆö‰πâÊØîËæÉÊñπÊ≥ï</h4>
<p>ÈÄöÂ∏∏Êàë‰ª¨‰ºöÈáçËΩΩÂÖÉÁ¥†ÁöÑËøêÁÆóÁ¨¶Êù•Ëá™ÂÆö‰πâ</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> node <span class="op">{</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> dis<span class="op">,</span> u<span class="op">;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&gt;(</span><span class="at">const</span> node<span class="op">&amp;</span> a<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> dis <span class="op">&gt;</span> a<span class="op">.</span>dis<span class="op">;</span> <span class="op">}</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>priority_queue<span class="op">&lt;</span>node<span class="op">,</span> vector<span class="op">&lt;</span>node<span class="op">&gt;,</span> greater<span class="op">&lt;</span>node<span class="op">&gt;</span> <span class="op">&gt;</span> pq<span class="op">;</span></span></code></pre></div>
<h4 id="ÊñπÊ≥ï">ÊñπÊ≥ï</h4>
<p>ÂÖ∂ÊñπÊ≥ï‰∏éstackÁõ∏ÂêåÔºåÂè™‰∏çËøáÊ≤°ÊúâÂÖàÂÖ•ÂêéÂá∫ÁâπÊÄßÔºåÊèíÂÖ•ÂÖÉÁ¥†ÊàñÂºπÂá∫ÂÖÉÁ¥†Âêé‰ºöÊ†πÊçÆÂ§ßÂ∞èÂÖ≥Á≥ªËøõË°åÊéíÂ∫èÔºå‰øùËØÅÊ†àÈ°∂ÊòØÊúÄÂ§ßÁöÑÔºàÊàñÊúÄÂ∞èÁöÑÔºâÂÖÉÁ¥†„ÄÇ</p>
<h3 id="stddeque">std::deque</h3>
<p>ÂèåÁ´ØÈòüÂàóÔºåÂÖÅËÆ∏Âú®ÈòüÈ¶ñÂíåÈòüÂ∞æËøõË°åÊèíÂÖ•ÂíåÂà†Èô§„ÄÇÂè¶Â§ñÔºåÂú® deque
‰ªª‰∏ÄÁ´ØÊèíÂÖ•ÊàñÂà†Èô§‰∏ç‰ºöÈùûÊ≥ïÂåñÊåáÂêëÂÖ∂‰ΩôÂÖÉÁ¥†ÁöÑÊåáÈíàÊàñÂºïÁî®„ÄÇÈÄöÂ∏∏‰πü‰ºöÁî®Êù•ÂÆûÁé∞ÂçïË∞ÉÈòüÂàó„ÄÇ</p>
<h4 id="ÊñπÊ≥ï-1">ÊñπÊ≥ï</h4>
<p>size„ÄÅempty‰∏éstack„ÄÅqueueÁõ∏Âêå„ÄÇÂÖ∂pop_back„ÄÅpush_back„ÄÅpop_front„ÄÅpush_front„ÄÅemplace_front„ÄÅemplace_backÁî®Ê≥ï‰πüÁ±ª‰ºº„ÄÇ</p>
<h3 id="stdvector">std::vector</h3>
<p>ÈÄöÂ∏∏ÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™ÂèØ‰ª•ÂèòÂåñÈïøÂ∫¶ÁöÑÊï∞ÁªÑ„ÄÇ</p>
<h4 id="Â£∞ÊòéÊñπÊ≥ï">Â£∞ÊòéÊñπÊ≥ï</h4>
<div class="sourceCode" id="cb59"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> vec<span class="op">;</span><span class="co">//Â£∞Êòé‰∏Ä‰∏™ÂàùÂßãÂ§ßÂ∞è‰∏∫0ÁöÑvector</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> vec2<span class="op">(</span>n<span class="op">);</span><span class="co">//Â£∞Êòé‰∏Ä‰∏™ÂàùÂßãÂ§ßÂ∞è‰∏∫nÁöÑvectorÔºåÊØè‰∏™ÂÖÉÁ¥†ÈÉΩ‰ºöÂàùÂßãÂåñ‰∏∫0</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> vec3<span class="op">(</span>n<span class="op">,</span><span class="dv">1</span><span class="op">);</span><span class="co">//‰∏é‰∏ä‰∏Ä‰∏™‰∏çÂêåÁöÑÊòØÔºåÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩ‰ºöÂàùÂßãÂåñ‰∏∫1</span></span></code></pre></div>
<h4 id="ÂÖÉÁ¥†ËÆøÈóÆ">ÂÖÉÁ¥†ËÆøÈóÆ</h4>
<div class="sourceCode" id="cb60"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>vec<span class="op">[</span><span class="dv">5</span><span class="op">];</span><span class="co">//ÂÉèÊï∞ÁªÑ‰∏ÄÊ†∑ËÆøÈóÆ</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>vec<span class="op">.</span>at<span class="op">(</span><span class="dv">5</span><span class="op">);</span><span class="co">//‰∏é‰∏ä‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÂ∑ÆÂà´Âú®‰ºöËøõË°åË∂äÁïåÊ£ÄÊü•</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>vec<span class="op">.</span>front<span class="op">();</span><span class="co">//ËÆøÈóÆÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>vec<span class="op">.</span>back<span class="op">();</span><span class="co">//ËÆøÈóÆÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†</span></span></code></pre></div>
<h4 id="size-3">::size</h4>
<p>Ëé∑ÂèñÂ§ßÂ∞èÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="empty-2">::empty</h4>
<p>Êü•ÁúãÊòØÂê¶‰∏∫Á©∫ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="push_back-1">::push_back</h4>
<p>ÂêëÊú´Â∞æÊ∑ªÂä†ÂÖÉÁ¥†ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="pop_back-1">::pop_back</h4>
<p>ÊääÊú´Â∞æÂÖÉÁ¥†ÂºπÂá∫ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="emplace_back">::emplace_back</h4>
<p>Âú®Êú´Â∞æÂéü‰ΩçÊûÑÈÄ†ÂÖÉÁ¥†ÔºåÂ§çÊùÇÂ∫¶ÔºöÂ∏∏Êï∞</p>
<h4 id="stdvector-1">std::vector<bool></h4>
<p>ËøôÊòØ‰∏Ä‰∏™ÁâπÂåñÁöÑvectorÔºåÂÆÉÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÊâÄÂç†ÁöÑÁ©∫Èó¥ÊòØ‰∏Ä‰ΩçÔºåËÄå‰∏çÊòØsizeof(bool)ÔºàÈÄöÂ∏∏ÊòØ‰∏ÄÂ≠óËäÇÔºâ„ÄÇ</p>
<h3 id="stdbitset">std::bitset</h3>
<p>Ë°®Á§∫‰∏Ä‰∏≤‰∫åËøõÂà∂‰Ωç„ÄÇ</p>
<h4 id="Â£∞ÊòéÊñπÊ≥ï-1">Â£∞ÊòéÊñπÊ≥ï</h4>
<div class="sourceCode" id="cb61"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>bitset<span class="op">&lt;</span><span class="dv">100</span><span class="op">&gt;</span> bs<span class="op">;</span><span class="co">//Â£∞Êòé‰∏Ä‰∏™‰ΩçÊï∞‰∏∫100‰ΩçÁöÑbitset</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>bitset<span class="op">&lt;</span><span class="dv">4</span><span class="op">&gt;</span> bs2<span class="op">{</span><span class="bn">0xA</span><span class="op">};</span><span class="co">//Â£∞Êòé‰∏Ä‰∏™Âõõ‰ΩçÁöÑbitsetÔºåÂÖ∂ÂÄºÁ≠â‰∫é0xA</span></span></code></pre></div>
<h4 id="ÂÖÉÁ¥†ËÆøÈóÆ-1">ÂÖÉÁ¥†ËÆøÈóÆ</h4>
<p>ÂêåÊï∞ÁªÑÁöÑËÆøÈóÆÊñπÂºè„ÄÇÂêåÊ†∑‰πüÂèØ‰ª•Áî®Êï∞ÁªÑÁöÑÊñπÂºèËøõË°å‰øÆÊîπ„ÄÇ</p>
<h4 id="allanynone">::all,::any,::none</h4>
<p>Ê£ÄÊü•ÊòØÂê¶ÂÖ®ÈÉ®ÔºåÂ≠òÂú®„ÄÅÊ≤°ÊúâÂÖÉÁ¥†Ë¢´ËÆæÁΩÆ‰∏∫true„ÄÇ</p>
<h4 id="count">::count</h4>
<p>ËøîÂõûËÆæÁΩÆ‰∏∫trueÁöÑÊï∞Èáè„ÄÇ</p>
<h4 id="ËøêÁÆó">ËøêÁÆó</h4>
<p>bitsetÂíåbitset‰πãÈó¥ËÉΩÁî®ÊâÄÊúâÁöÑ‰ΩçËøêÁÆóÁ¨¶„ÄÇ‰πüÂèØ‰ª•Áî®Á≠âÂè∑Âíå‰∏çÁ≠âÂè∑ÊØîËæÉ„ÄÇ</p>
<h4 id="flip">::flip</h4>
<p>ÁøªËΩ¨Êüê‰∏Ä‰ΩçÁöÑÂÄº„ÄÇ</p>
<h4 id="to_string">::to_string</h4>
<p>ËΩ¨Âåñ‰∏∫‰∫åËøõÂà∂Êï∞ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ</p>
<h4 id="to_ulongto_ullong">::to_ulong,::to_ullong</h4>
<p>ËΩ¨Âåñ‰∏∫unsigned longÂíåunsigned long long„ÄÇ</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E7%AE%97%E6%B3%95/">ÁÆóÊ≥ï</a>
        
            <a href="/tags/%E6%A8%A1%E6%9D%BF/">Ê®°Êùø</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/p/atcoder-beginner-conteset-263-e%E6%A6%82%E7%8E%87dp/">
        
        

        <div class="article-details">
            <h2 class="article-title">Atcoder Beginner Conteset 263 EÔºàÊ¶ÇÁéáDPÔºâ</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/%E5%8F%96%E4%BD%99%E8%BF%90%E7%AE%97%E7%9A%84%E5%88%86%E9%85%8D%E5%BE%8B/">
        
        

        <div class="article-details">
            <h2 class="article-title">Âèñ‰ΩôËøêÁÆóÁöÑÂàÜÈÖçÂæã</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/%E7%AE%97%E6%B3%95%E9%A2%98-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/">
        
        
            <div class="article-image">
                <img src="/p/%E7%AE%97%E6%B3%95%E9%A2%98-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/1.79caa0d7397355f82035319e18420be7_hue13a31d22502e6414becf06d466eec8f_119570_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-ecqg1zlzVfggNTGeGEIL5w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ÁÆóÊ≥ïÈ¢ò-ÁΩëÁªúËÆæÂ§áÁÆ°ÁêÜ</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/%E7%AE%97%E6%B3%95%E9%A2%98-%E5%90%91%E9%87%8F/">
        
        

        <div class="article-details">
            <h2 class="article-title">ÁÆóÊ≥ïÈ¢ò-ÂêëÈáè</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/%E7%AE%97%E6%B3%95%E9%A2%98-%E6%9C%89%E9%99%90%E5%B0%8F%E6%95%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">ÁÆóÊ≥ïÈ¢ò-ÊúâÈôêÂ∞èÊï∞</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="kegalas/blogComments"
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 KegalaSÁöÑ‰∏™‰∫∫ÂçöÂÆ¢
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.4.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
