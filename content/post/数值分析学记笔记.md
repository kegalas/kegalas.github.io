---
title: "数值分析学记笔记"
date: 2022-10-02T16:42:53+08:00
draft: false
tags: [数学,数值分析]
description: Timothy Sauer所著《数值分析（第二版）》的学习笔记
categories: 数学
mathjax: true
markup: pandoc
---

# 基础知识

## 多项式求值

对于形如下式的多项式

$$
P(x)=2x^4+3x^3-3x^2+5x-1
$$

如果我们普通地代入计算，则会需要计算10次乘法，以及4次加法。这显然不是最优的，更优的方法例如秦九韶算法，将多项式重写为

$$
P(x)=-1+x*(5+x*(-3+x*(3+x*2)))
$$

此时再代入值计算，则只用4次乘法和4次加法。一般来说$d$阶多项式可以通过$d$次乘法和$d$次加法求值。

标准形式的多项式

$$
P(x) = c_1+c_2x+c_3x^2+c_4x^3+c_5x^4
$$

可以写成

$$
P(x)=c_1+x(c_2+x(c_3+x(c_4+x(c_5))))
$$

或者也有更一般的形式，可以用于之后的插值计算

$$
P(x)=c_1+(x-r_1)(c_2+(x-r_2)(c_3+(x-r_3)(c_4+(x-r_4)(c_5))))
$$

其中称$r1,r2,r3,r4$为基点。

## 二进制数字

二进制数字可以表示为：

$$
\cdots b_2b_1b_0b_{-1}b_{-2}\cdots
$$

其等价于十进制下的

$$
\cdots b_22^2+b_12^1+b_02^0+b_{-1}2^{-1}+b_{-2}2^{-2}\cdots
$$

### 十进制转化为二进制

例如$53.7$转化为二进制，可以拆分为整数部分和小数部分，分别转化，然后在拼接起来。

**整数部分**

将整数连续除以$2$，记录余数，直到整数最后变为$0$，余数反过来排列在一起就是二进制表示。例如

$$
53\div 2 = 26\cdots1
$$

$$
26\div 2 = 13\cdots0
$$

$$
13\div 2 = 6\cdots1
$$

$$
6\div 2 = 3\cdots0
$$

$$
3\div 2 = 1\cdots1
$$

$$
1\div 2 = 0\cdots1
$$

那么二进制表示就是$110101$

**小数部分**

将小数部分不断乘以$2$，得到的结果保留整数部分，直到小数部分为$0$，整数部分顺序排列即为小数部分的二进制表示

例如

$$
0.7*2 = 0.4+1
$$

$$
0.4*2 = 0.8+0
$$

$$
0.8*2 = 0.6+1
$$

$$
0.6*2 = 0.2+1
$$

$$
0.2*2 = 0.4+0
$$

$$
0.4*2 = 0.8+0
$$

$$
\vdots
$$

后面重复，代表在二进制中是无限循环小数。有$(0.7)_{10}=(0.1\overline{0110})_2$

最后有$(53.7)_{10} = (110101.1\overline{0110})_2$。

### 二进制转化为十进制

开头已经介绍过一般情况，对于有限小数是容易计算的。

无限小数时，例如$x=(0.\overline{1011})_2$，先左移$4$位，再减去原始的$x$，有

$$
2^4x = 1011.\overline{1011}\\
x=0000.\overline{1011}
$$

相减得

$$
(2^4-1)x = (1101)_2 = (11)_{10}
$$

求解$x$可得，$x=(0.\overline{1011})_2=11/15$。

## 实数的浮点表示

本节按照IEEE754标准。

### 浮点格式

一个浮点数字包含三个部分：符号（正负）、尾数（包含一串有效数位）和一个指数，这些部分都在一个计算机字(WORD)里。

浮点数常用三种精度级别：单精度、双精度、扩展精度。它们分配的数位分别是32、64、80。具体如下

|   精度    |   符号   |  指数  | 尾数 |
| :-: | :-: | :-: | :-: |
|  单精度  | 1 | 8 | 23 |
| 双精度 | 1 | 11 | 52 |
| 扩展精度 | 1 | 15 | 64 |

三种精度以相同的方式运行。标准化的IEEE浮点数表示为

$$
\pm 1.bbb\cdots b\times 2^p
$$

其中$N$个$b$或0或1，$p$是一个$M$位的二进制数表示指数。最左边的一位（主导数位）必须是$1$。

当一个二进制数用一个标准浮点数字表示的时候，它被称为“左对齐”，意味着其中最左边的一个数位$1$被平移到小数点的左边，平移通过指数的变化来补偿，例如，十进制数$9$，对应的二进制数$1001$保存为

$$
+1.001\times 2^3
$$

以双精度（$M=11,N=52$）为例，1的双精度表示为

$$
+1.0000000000000000000000000000000000000000000000000000\times 2^0
$$

其中有52位尾数，下一个比$1$大的浮点数是

$$
+1.0000000000000000000000000000000000000000000000000001\times 2^0
$$

或者说是$1+2^{-52}$

**定义1**

机器精度对应的数字，记作$\varepsilon_{math}$，是$1$和比$1$大的最小浮点数之间的距离。对于双进度来说就是$2^{-52}$

如果一个小数是无限小数，或者是超过了52位的小数，IEEE规定，如果在第53位为0，则52位以后的全部社区，如果53位为1，则在52位上加1。特别的，如果第53位为1，其后所有已知位为0，那么当且仅当52位是1时在52位上加1。

上述方法称为IEEE舍入最近法则。

**定义2**

将IEEE双精度浮点数字记做$x$，利用舍入最近法则记做$fl(x)$

在计算机算术中，实数$x$用一串数位$fl(x)$替换。根据这个定义，$9.4$在二进制中表示如下

$$
+1.0010110011001100110011001100110011001100110011001100|110\cdots\times 2^3
$$

则$fl(9.4)$表示为

$$
+1.0010110011001100110011001100110011001100110011001101\cdots\times 2^3
$$

我们通过去掉最右边无穷长的数字尾巴$0.\overline{1100}\times 2^{-52}\times 2^3=\overline{0.0110}\times 2^{-51}\times 2^3=0.4\times 2^{-48}$得到浮点表达。并在舍入过程中加上$2^{-52}\times 2^3=2^{-49}$。因而

$$
fl(9.4) = 9.4+2^{-49}-0.4\times 2^{-48}\\
=9.4+(1-0.8)2^{-49}\\
=9.4+0.2\times 2^{-49}
$$

换句话说，将$9.4$保存为双精度浮点数时可能产生了$0.2\times 2^{-49}$的误差，我们把它称作舍入误差。

**定义3**

令$x_c$是计算版本$x$的精确度量，则

$$
绝对误差=|x_c-x|
$$

$$
相对误差=\frac{|x_c-x|}{|x|}(x\neq 0)
$$

**相对舍入误差**

在IEEE机器算术模型中，$fl(x)$的相对舍入误差不会比机器精度的一半大：

$$
\frac{|fl(x)-x|}{|x|}\leq \frac{1}{2}\varepsilon_{math}
$$

### 浮点数的机器表示

每个双精度浮点数字被分配了8字节，或者说64位，来存储对应的三个部分。每个字都有如下形式

$$
se_1e_2\cdots e_{11}b_1b_2\cdots b_{52}
$$

其中第1位保存了符号位，后面11位用于保存指数，再后面小数点后的52位保存尾数。符号位0是正数，1是负数。11位指数表示的正二进制整数，这些正数通过往指数上叠加$2^10-1=1023$得到，指数范围在$-1022$和$1023$之间，$e_1\cdots e_{11}$覆盖了从$1$到$2046$之间对应的指数，由于特殊目的，没有使用$0$和$2047$。

数字$1023$称为双精度格式的指数偏差。它被用于吧正和负指数转化为正的二进制数保存在指数位中，对于单精度和扩展精度，指数偏差位分别是127和16383.

也就是说，指数位上的数字，减去1023才是浮点数中所应该是的指数。

再来看特殊值$2047$。如果尾数位串都是0，则用于表示$\infty$（其符号取决于第一位），否则表示$NaN$，意为不是一个数字。

例如$1/0$是$+\inf$，前$12$位用十六进制表示为7FF，后面全是0.

$-1/0$是$-\inf$，前$12$位用十六进制表示为FFF，后面全是0.

$0/0$是$NaN$，前$12$位用十六进制表示为FFF，后面不全是0.

再来看特殊值$0$，意味着$e_1e_2\cdots e_{11}=(000 0000 0000)_2$。其表示一个非标准浮点数

$$
\pm 0.b_1b_2\cdots b_{52}\times 2^{-1022}
$$

由上可见，第一位不再假设为1.这样的非标准化数字称作异常浮点数字。这样就扩展了数字的表示范围，因而，最小的可表达的双精度数字是$2^{-52}\times 2^{-1022}$。

另外$+0,-0$也是一个异常数字。计算中它们被看作是相同的两个实数。

### 浮点数加法

首先对齐进行加法的两个数字的小数点位，接着相加，然后把结果保存为浮点数字。

在加法寄存器中，可以进行超过52位的加法，但是在相加之后必须舍入变回52位。

## 有效数字缺失

有一个主要问题以多种形式出现，该问题是由于对近似相等的两个数字相减造成有效数字的位数减少。

例如$123.4567-123.4566=0.0001$，有效数字从原来的七位减少到一位。

很多情况下我们可以通过重新构造计算来解决这个问题。

**例1**

在三位小数的计算机上计算$\sqrt{9.01}-3$

正确的结果接近$1.6662\times 10^{-3}$，但当我们使用三位有效数字时，由于$\sqrt{9.01}\approx 3.0016662$，保存三位有效数字时得到$3.00$。再减去$3.00$，得到$0.00$，没有一个有效数位是正确的。

但是我们可以用以下方法挽救

$$
\sqrt{9.01}-3 = \frac{(\sqrt{9.01}-3)(\sqrt{9.01}+3)}{\sqrt{9.01}+3}=\frac{9.01-9}{\sqrt{9.01}+3}
$$

$$
=\frac{0.01}{3.00+3.00}=\frac{0.01}{6}=0.00167\approx 1.67\times 10^{-3}
$$

这种方法本质上是一个窍门。称作“共轭等式”。通常会使用一些特定的恒等式，例如三角恒等式。

例如

$$
E_1=\frac{1-cosx}{sin^2x},E_2=\frac{1}{1+cosx}
$$

两个式子虽然等价，但是在数值计算上，输入一个较为靠近0的数，则第二个比第一个精度高。

**例2**

解方程$ax^2+bx+c=0$

对于最基础的求根公式

$$
x=\frac{-b\pm \sqrt{b^2-4ac}}{2a}
$$

其中间取负号问题可能不大，但是取正号时，如果$ac$相对于$b^2$非常小，则分式上面会直接舍入等于0，造成整个结果等于0.

为了解决这个问题，可以在$b$是正数时

$$
x_1=-\frac{b+\sqrt{b^2-4ac}}{2a},x_1=-\frac{2c}{b+\sqrt{b^2-4ac}}
$$

$b$是负数时

$$
x_1=\frac{-b+\sqrt{b^2-4ac}}{2a},x_1=\frac{2c}{-b+\sqrt{b^2-4ac}}
$$
